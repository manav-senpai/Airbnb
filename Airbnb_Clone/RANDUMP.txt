--- directory structure ---

AIRBNB_CLONE/
├── backend/
│   ├── config/
│   │   ├── cloudinary.js
│   │   ├── db.js
│   │   └── token.js
│   ├── controllers/
│   │   ├── auth.controller.js
│   │   ├── booking.controller.js
│   │   ├── listing.controller.js
│   │   └── user.controller.js
│   ├── middleware/
│   │   ├── isAuth.js
│   │   └── multer.js
│   ├── model/
│   │   ├── booking.model.jsx
│   │   ├── listing.model.js
│   │   └── user.model.js
│   ├── public/
│   │   └── temp/
│   ├── routes/
│   │   ├── auth.route.js
│   │   ├── booking.route.js
│   │   ├── listing.route.js
│   │   └── user.route.js
│   ├── .env
│   ├── index.js
│   ├── package.json
│   └── package-lock.json
│
├── frontend/
│   ├── node_modules/
│   ├── public/
│   ├── src/
│   │   ├── assets/
│   │   │   └── logo.png
│   │   ├── Component/
│   │   │   ├── Card.jsx
│   │   │   ├── Nav.jsx
│   │   │   └── Star.jsx
│   │   ├── Context/
│   │   │   ├── AuthContext.jsx
│   │   │   ├── BookingContext.jsx
│   │   │   ├── ListingContext.jsx
│   │   │   └── UserContext.jsx
│   │   ├── pages/
│   │   │   ├── Booked.jsx
│   │   │   ├── HomePage.jsx
│   │   │   ├── ListingPage1.jsx
│   │   │   ├── ListingPage2.jsx
│   │   │   ├── ListingPage3.jsx
│   │   │   ├── LoginPage.jsx
│   │   │   ├── MyBooking.jsx
│   │   │   ├── MyListing.jsx
│   │   │   ├── SignUpPage.jsx
│   │   │   └── ViewCard.jsx
│   │   ├── App.css
│   │   ├── App.jsx
│   │   ├── index.css
│   │   └── main.jsx
│   ├── airbnb_logo.png
│   ├── eslint.config.js
│   ├── index.html
│   ├── package.json
│   ├── package-lock.json
│   ├── postcss.config.js
│   ├── README.md
│   ├── tailwind.config.js
│   └── vite.config.js

_____________________________________

--- backend/config/cloudinary.js ---

""" import { v2 as cloudinary } from 'cloudinary';
import fs from "fs";
import dotenv from "dotenv";

dotenv.config();

// FIX: Ensure config is called OUTSIDE the function so it runs on startup
cloudinary.config({ 
    cloud_name: process.env.CLOUDINARY_CLOUD_NAME, 
    api_key: process.env.CLOUDINARY_API_KEY,      // FIX: Added process.env
    api_secret: process.env.CLOUDINARY_API_SECRET // FIX: Added process.env
});

const uploadOnCloudinary = async (filepath) => {
    try {
        if (!filepath) return null;

        // Upload to Cloudinary
        const uploadResult = await cloudinary.uploader.upload(filepath, {
            resource_type: "auto"
        });

        // FIX: Typo was 'uplinkSync', changed to 'unlinkSync'
        // This deletes the local file after upload
        fs.unlinkSync(filepath);

        // FIX: Return ONLY the URL string, not the whole object
        return uploadResult.secure_url; 

    } catch (error) {
        console.error("Cloudinary Error:", error);
        // Safely delete file if upload fails
        if (fs.existsSync(filepath)) {
            fs.unlinkSync(filepath);
        }
        return null;
    }
}

export default uploadOnCloudinary;
"""

_____________________________________

--- backend/config/db.js ---

""" import mongoose from "mongoose";

const connectDb = async () => {
    try {
        await mongoose.connect(process.env.MONGODB_URL)
        console.log("DB connected")
    } catch (error) {
        console.log("db error")
    }
}
 
export default connectDb
"""

_____________________________________

--- backend/config/token.js ---

""" 
import jwt from "jsonwebtoken"

const genToken = async (userId) => {

    try{
        let token = await jwt.sign({userId},process.env.JWT_SECRET,{expiresIn:"7d"})
        return token
    } catch (error){
        console.log("token error")
    }


}

export default genToken
"""
_____________________________________

--- backend/controllers/auth.controller.js ---
"""
import genToken from "../config/token.js"
import User from "../model/user.model.js"
import bcrypt from "bcryptjs"

export const signUp=async (req,res) =>{
    try{
        let {name, email, password} = req.body
        let existUser = await User.findOne({email})
        if(existUser){
            return res.status(400).json({message:"User already exists"})
        }
        let hashPassword = await bcrypt.hash(password, 10)
        let user = await User.create({name, email, password:hashPassword})
        let token = await genToken(user._id)
        res.cookie("token", token, {
            httpOnly:true,
            secure:process.env.NODE_ENVIRONMENT = "production",
            sameSite : "strict",
            maxAge : 7 * 24 * 60 * 60 * 1000


        })
        return res.status(201).json(user)

    } catch (error) {
        return res.status(500).json({message:`signup eror ${error}`})
    }
}

export const login = async (req,res) => {
    try{
        let {email, password} = req.body
        let user = await User.findOne({email})
        if(!user){
            return res.status(400).json({message:"User does not exist"})
        }
        let isMatch = await bcrypt.compare(password, user.password)
        if(!isMatch){
            return res.status(400).json({message:"Incorrect Password"})

        }
        let token = await genToken(user._id)
        res.cookie("token", token, {
            httpOnly:true,
            secure:process.env.NODE_ENVIRONMENT = "production",
            sameSite : "strict",
            maxAge : 7 * 24 * 60 * 60 * 1000


        })
        return res.status(200).json(user)
        
        
    }
    catch (error){
        
        return res.status(500).json({message:`Login error ${error}`})
        
    }
}

export const logOut = async(req,res) => {
    try{
        res.clearCookie("token")
        return res.status(200).json({message:"Logout Successfully"})
    }
    catch(error){

        return res.status(500).json({message:`Logout error ${error}`})

    }
}
"""

_____________________________________

--- backend/controllers/booking.controller.js ---
"""

export const createBooking = async (req, res) => {

    try {
        let {id} = req.params
        let {checkIn, checkOut, totalRent} = req.body

        let listing = await Listing.findById(id)
        if(!listing){
                return res.status(404).json({ message: "Listing not found" });
        
        }
        if(new Date(checkIn) >= new Date(checkOut)){
            return res.status(400).json({ message: "Check-out date must be after check-in date" });
        }
         if(listing.isbooked){
            return res.status(400).json({ message: "Listing is already booked" });
        }

        let booking = await Booking.create({
            checkIn,
            checkOut,
            totalRent,
            host: listing.host,
            guest: req.user._id,
            listing: listing._id
        })
        await booking.populate("host", "email")
        
        let user = await User.findByIdAndUpdate(req.userId, {
            $push:{booking: booking._id}
        }, {new:true}) 

        if(!user){
            return res.status(404).json({ message: "User not found" });
        }
        listing.guest = req.userId 
        listing.isbooked = true
        await listing.save()
        res.status(201).json(booking)
        
        } catch (error) {
                return res.status(400).json({ message: `booking error ${error.message}` });
        }
    }

    export const cancelBooking = async (req, res) => {
        try {
            let {id} = req.params
            let listing = await Listing.findByIdAndUpdate(id, {isBooked: false})
            let user = await User.findByIdAndUpdate(listing.guest, {
                $pull:{booking:listing._id}
            }, {new:true})
            if(!user){
                return res.status(404).json({ message: "User not found" });
            }

            return res.status(200).json({ message: "Booking cancelled successfully" });
        } catch (error) {
            return res.status(400).json({ message: `cancel booking error ${error.message}` });
        }
    }  
    """

    _____________________________________

    --- backend/controllers/listing.controller.js ---
 
""" 
import uploadOnCloudinary from "../config/cloudinary.js";
import Listing from "../model/listing.model.js";
import User from "../model/user.model.js";

export const addListing = async (req, res) => {
    try {
        let host = req.userId;
        // 1. Extract new fields from req.body
        let { title, description, rent, city, landmark, category, guestCapacity, bedroomCount, bathroomCount } = req.body;

        console.log("Files received:", req.files); 

        const img1LocalPath = req.files?.image1?.[0]?.path;
        const img2LocalPath = req.files?.image2?.[0]?.path;
        const img3LocalPath = req.files?.image3?.[0]?.path;

        if (!img1LocalPath) {
            return res.status(400).json({ message: "Primary image is required" });
        }

        let image1 = await uploadOnCloudinary(img1LocalPath);
        let image2 = img2LocalPath ? await uploadOnCloudinary(img2LocalPath) : "";
        let image3 = img3LocalPath ? await uploadOnCloudinary(img3LocalPath) : "";

        // 2. Create listing with new fields
        let listing = await Listing.create({
            title, description, rent, city, landmark, category,
            guestCapacity, bedroomCount, bathroomCount, // <--- Added here
            image1, image2, image3, host
        });

        let user = await User.findByIdAndUpdate(host, {
            $push: { listings: listing._id }
        }, { new: true });

        if (!user) {
            return res.status(404).json({ message: "User not found" });
        }

        res.status(201).json(listing);

    } catch (error) {
        console.error("Addlisting error:", error);
        res.status(500).json({ message: `Addlisting error: ${error.message}` });
    }
};

export const getListing = async (req, res) => {
    try {
        const listings = await Listing.find().sort({ createdAt: -1 });
        res.status(200).json(listings);
    } catch (error) {
        res.status(500).json({ message: error.message });
    }
};

export const findlistingByid = async (req, res) => {
    try {
        const { id } = req.params;
        const listing = await Listing.findById(id).populate("host", "username email"); // Populated host to show name in ViewCard
        if (!listing) return res.status(404).json({ message: "Listing not found" });
        res.status(200).json(listing);
    } catch (error) {
        res.status(500).json({ message: error.message });
    }
};

export const deleteListing = async (req, res) => {
    try {
        const { id } = req.params;
        const listing = await Listing.findByIdAndDelete(id);
        
        if (!listing) {
            return res.status(404).json({ message: "Listing not found" });
        }

        // Remove from host's list
        await User.findByIdAndUpdate(listing.host, {
            $pull: { listings: id }
        });

        res.status(200).json({ message: "Listing deleted successfully" });
    } catch (error) {
        res.status(500).json({ message: error.message });
    }
};

export const findlisting = async (req, res) => {
    try {
        let {id} = req.params
        let listing = await Listing.findById(id)
        if(!listing){
            res.status(404).json({message:"Listing not found"})
        }
        res.status(200).json(listing)
    } catch (error) {
        res.status(500).json(`findlisting error ${error.message} `)
    }
}

export const ratelisting = async (req, res) => {
    try {
        let {id} = req.params
        let {rating} = req.body
        let listing = await Listing.findById(id)
        if(!listing){
            res.status(404).json({message:"Listing not found"})
        }
        listing.ratings = Number(rating)
        await listing.save();
        return res.status(200).json({message:"Rating submitted successfully"})


    } catch (error) {
        res.status(500).json(`ratelisting error ${error.message} `)
    }
};


export const search = async (req, res) => {
    try {
         const { query } = req.query;

         if (!query) {
            return res.status(400).json({ message: "Query parameter is required" });
        }
        const listings = await Listing.find({
            $or: [
                {landmark: { $regex: query, $options: "i" }},
                {city: { $regex: query, $options: "i" }},
                {title: { $regex: query, $options: "i" }}

            ]
        })
        res.status(200).json(listings);
    } catch (error) {
        console.error("Search error:", error);
        res.status(500).json({ message: `Search error: ${error.message}` });
    }
};

_____________________________________

--- backend/controllers/user.controller.js ---

"""
import User from "../model/user.model.js"


export const getCurrentUser = async (req , res ) => {
    try {
        let user = await User.findById ( req.userId).select("-password").populate("listing", "title image1 image2 image3 description rent city landMark host isBooked ratings")
        .populate("listing", "title image1 image2 image3 description rent city landMark host isBooked ratings")
            res.status(400).json({message:"User is not found"})
        }
        res.status(200).json(user)
        
    } catch {
        res.status(500).json({message:`getCurrentUser error ${error}`})

    }
}
"""

_____________________________________

--- backend/middleware/isAuth.js ---
"""

import pkg from 'jsonwebtoken';
const { verify } = pkg; // We extract 'verify' here

const isAuth = async (req, res, next) => {
    try {
        let { token } = req.cookies;
        
        if (!token) {
            return res.status(401).json({ message: "User doesn't have a token" });
        }

        // FIX: Removed 'jwt.' prefix. Just use 'verify'
        let verifyToken = verify(token, process.env.JWT_SECRET);
        
        if (!verifyToken) {
            return res.status(401).json({ message: "User doesn't have a valid token" });
        }

        // Safety check for ID
        req.userId = verifyToken.id || verifyToken.userId || verifyToken._id;
        next();

    } catch (error) {
        console.error("isAuth Error:", error);
        res.status(500).json({ message: `isAuth error ${error.message}` });
    }
}

export default isAuth;
"""
_____________________________________

--- backend/middleware/multer.js ---


"""import multer from "multer";
import fs from "fs";

// Ensure the directory exists before saving
const uploadDir = "./public/temp";
if (!fs.existsSync(uploadDir)){
    fs.mkdirSync(uploadDir, { recursive: true });
}

const storage = multer.diskStorage({
    destination: (req, file, cb) => {
        // Saves to 'public/temp' inside backend
        cb(null, uploadDir); 
    },
    filename: (req, file, cb) => {
        // FIX: Correct comma syntax inside the function call
        cb(null, file.originalname); 
    }
});

const upload = multer({ storage });

export default upload;

"""
_____________________________________

--- backend/model/booking.model.jsx ---

"""
import mongoose  from "mongoose";
import { listingDataContext } from "../../frontend/src/Context/ListingContext";

const boockingSchema = new mongoose.Schema({
    host:{
        type:mongoose.Schema.Types.ObjectId,
        ref:"User",
        required:true
    },
    guest:{
        type:mongoose.Schema.Types.ObjectId,
        ref:"User",
        required:true
    },
    listing:{
        type:mongoose.Schema.Types.ObjectId,
        ref:"Listing",
        required:true

    },
    status:{
        type:String,
        enum:["boocked", "cancel"],
        default:"boocked"
    },
    checkIn:{
        type:Date,
        required:true
    },
    checkOut:{
        type:Date,
        required:true
    }, 
    totalRent:{
        type:Number,
        required:true
    }
},{timestamp:true})


const booking = mongoose.model("Booking", boockingSchema)

export default booking

"""
_____________________________________

--- backend/model/listing.model.js ---
"""
import mongoose from "mongoose"

const listingSchema = new mongoose.Schema({
    title: {
        type: String,
        required: true
    },
    description: {
        type: String,
        required: true
    },
    host: {
        type: mongoose.Schema.Types.ObjectId,
        ref: "User",
        required: true
    },
    image1: {
        type: String,
        required: true
    },
    image2: {
        type: String,
        required: true
    },
    image3: {
        type: String,
        required: true
    },
    rent: {
        type: Number,
        required: true
    },
    city: {
        type: String,
        required: true
    },
    landmark: { 
        type: String,
        required: true
    },
    category: {
        type: String,
        required: true
    },
    ratings:{
        type:Number,
        min:0,
        max:5,
        default:0
    },
    
    // --- NEW FIELDS ADDED ---
    guestCapacity: {
        type: Number,
        required: true,
        default: 1
    },
    bedroomCount: {
        type: Number,
        required: true,
        default: 1
    },
    bathroomCount: {
        type: Number,
        required: true,
        default: 1
    },
    // ------------------------
    isBooked: {
        type: Boolean,
        default: false
    },
    reviews: [
        {
            user: { type: mongoose.Schema.Types.ObjectId, ref: "User" },
            rating: { type: Number, required: true },
            comment: { type: String, default: "" }
        }
    ],
    averageRating: {
        type: Number,
        default: 0
    }

}, { timestamps: true })

const Listing = mongoose.model("Listing", listingSchema)

export default Listing
"""
_____________________________________

--- backend/model/user.model.js ---

import mongoose from "mongoose";

const userSchema = new mongoose.Schema({
    name:{
        type:String, 
        required:true
    }, 
    email:{
        type:String,
        required:true
    },
    password:{
        type:String,
        required:true
    },
    listing:{
        type:mongoose.Schema.Types.ObjectId,
        ref:"Listing"
    },
    booking:{
        type:mongoose.Schema.Types.ObjectId,
        ref:"Listing"

    }
},{timestamp:true})

const User = mongoose.model("User", userSchema)

export default User
"""

_____________________________________

--- backend/routes/auth.route.js ---
"""
import express from "express"
import {login,logOut, signUp} from "../controllers/auth.controller.js"

const authRouter = express.Router()

authRouter.post("/signup",signUp)
authRouter.post("/login",login)
authRouter.post("/logout",logOut)

export default authRouter
"""

_____________________________________

--- backend/routes/booking.route.js ---
"""

import express from 'express';
import isAuth from '../middleware/isAuth';
import { createBooking } from '../controllers/booking.controller.js';

let bookingRouter = express.Router();

bookingRouter.post("/create/:id ", isAuth, createBooking)
bookingRouter.delete("/cancel/:id ", isAuth, cancelBooking)



export default bookingRouter;
"""
_____________________________________

--- backend/routes/listing.route.js ---

"""
import express from "express";
import isAuth from "../middleware/isAuth.js";
import upload from "../middleware/multer.js";
// FIX: Added deleteListing to imports
import { addListing, getListing, findlistingByid, deleteListing, ratelisting, search } from "../controllers/listing.controller.js";

let listingRouter = express.Router();

listingRouter.post("/add", isAuth, upload.fields([
    { name: "image1", maxCount: 1 },
    { name: "image2", maxCount: 1 },
    { name: "image3", maxCount: 1 }
]), addListing);

listingRouter.get("/get", getListing);
listingRouter.get("/findlistingByid/:id", findlistingByid);
listingRouter.delete("/delete/:id", deleteListing);
listingRouter.post("/ratings/:id", isAuth, ratelisting);
listingRouter.get("/search", search);

// --- THIS WAS MISSING ---
listingRouter.delete("/delete/:id", isAuth, deleteListing);

export default listingRouter;
"""

_____________________________________

--- backend/routes/user.route.js ---
"""
import express from "express"
import isAuth from "../middleware/isAuth.js"
import { getCurrentUser } from "../controllers/user.controller.js"

// Use parentheses () to initialize the router
const userRouter = express.Router() 

// Changed .length to .get
userRouter.get("/currentuser", isAuth, getCurrentUser)

export default userRouter
"""
_____________________________________

--- backend/index.js ---

"""
import express from "express"
import dotenv from "dotenv"
import connectDb from "./config/db.js"
import authRouter from "./routes/auth.route.js"
import cookieParser from "cookie-parser"
import cors from "cors" // 1. Import CORS
import userRouter from "./routes/user.route.js"
import listingRouter from "./routes/listing.route.js"
import bookingRouter from "./routes/booking.route.js"

dotenv.config()

let port = process.env.PORT || 8000 // Ensure this matches your frontend serverUrl

let app = express()

// 2. Configure CORS before your routes
app.use(cors({
    origin: "http://localhost:5173", // Your frontend URL
    credentials: true                // Required for cookies/sessions
}))

app.use(express.json())
app.use(cookieParser())

// Routes
app.use("/api/auth", authRouter)
app.use("/api/user", userRouter)
app.use("/api/listing", listingRouter)
app.use("/api/booking", bookingRouter)

// Error handling middleware (Good to have so it doesn't just hang on errors)
app.use((err, req, res, next) => {
    const statusCode = err.statusCode || 500;
    const message = err.message || "Internal Server Error";
    return res.status(statusCode).json({
        success: false,
        statusCode,
        message,
    });
});

app.listen(port, () => {
    connectDb()
    console.log(`Server started on port ${port}`)
})
"""
_____________________________________
<<< i guess no need for package-lock.json ...but if required... tell me.. >>>
_____________________________________

--- backend/package.json ---

"""
{
  "name": "backend",
  "version": "1.0.0",
  "description": "",
  "license": "ISC",
  "author": "",
  "type": "module",
  "main": "index.js",
  "scripts": {
    "dev": "nodemon index.js"
  },
  "dependencies": {
    "bcryptjs": "^3.0.3",
    "cloudinary": "^2.9.0",
    "cookie-parser": "^1.4.7",
    "cors": "^2.8.6",
    "dotenv": "^17.2.3",
    "express": "^5.2.1",
    "jsonwebtoken": "^9.0.3",
    "mongoose": "^9.1.6",
    "multer": "^2.0.2",
    "nodemon": "^3.1.11"
  }
}

"""
_____________________________________
--- backend/.env ---

"""
PORT = 8000
MONGODB_URL = "mongodb+srv://manavahire60:Test%40123@cluster0.whr8rqh.mongodb.net/AirbnbClone"

JWT_SECRET = "34PCJ4PXFP84JXPWJOMJ4"
NODE_ENVIRONMENT = "development"
CLOUDINARY_CLOUD_NAME = "dqksw5pwj"
CLOUDINARY_API_KEY = "819839441285697"
CLOUDINARY_API_SECRET = "J6B1fYVYrfTQkvDPWp8P629QbRk"

"""

_____________________________________

<<< done with the backend.. now time for frontend..>>>

_____________________________________

--- frontend/src/assets/logo.png ---
_____________________________________

--- frontend/src/Component/Card.jsx ---
"""import React, { useContext } from 'react';
import { FaStar, FaRegStar } from "react-icons/fa";
// 1. Import ListingContext
import { listingDataContext } from '../Context/ListingContext';
import { FaRegCheckCircle } from "react-icons/fa";
import { FcCancel } from "react-icons/fc";
import { useState } from 'react';

function Card({ title, landMark, city, image1, rent, id, ratings, isBooked, host }) {
    // 2. Get the handleViewCard function from Context
    const { handleViewCard } = useContext(listingDataContext);
    let navigate = useNavigate()
    let{userData} = useContext(userDataContext)
    // let {handleViewCard } = useContext(listingDataContext)
    let{popUp, setPopUp} = useState
    let {cancelBooking} = useContext(bookingDataContext)
    const handleClick = () => {
        if (userData) {
            handleViewCard(id);
        } else {
            navigate("/login");
            
        }
       
        handleViewCard(id);
    };

    return (
        
        <div 
            className='w-[300px] md:w-[320px] h-[400px] flex flex-col rounded-2xl cursor-pointer hover:shadow-2xl transition-all duration-300 bg-white border border-gray-200 overflow-hidden group p-3 gap-3 relative' 
            onClick={()=>! isBooked? handleClick(): null}
        >
            { !isBooked && <div className='text-[green] bg-white rounded-lg absolute flex items-center justify-center right-1 top-1 gap-[5px] p-[5px] '><FaRegCheckCircle className='w-[20px] h-20px text-[green]'/> <FaRegCheckCircle className='w-[20px] h-[20px text-[green]' />Booked </div>}
            { isBooked && host == userData?._id && <div className='text-[green] bg-white rounded-lg absolute flex items-center justify-center right-1 top-[50px] gap-[5px] p-[5px]' onClick={()=> setPopUp(true)} ><FcCancel className='w-[20px] h-[20px]' /> Cancel Booking</div>}

<div className='w-[300px] h-[100px] bg-[#ffffffdf] absolute top-[110px] left-[13px] rounded-lg'>
    {popUp && <div className="w-[100%] h-[50%] text-[18px] font-semibold flex items-start justify-center gap-[10px] text-[#986b6b]">
        <div className='w-[100%] h-[50%] text-[#2e2d2d] flex items-start justify-center rounded-lg overflow-auto text-[20px] p-[10px]'>Booking Cancel !</div>
        Are you sure?
        <button className="px-[20px] bg-[red] text-[white] rounded-lg hover:bg-slate-600" onClick={()=> {cancelBooking(id); setPopUp(false)}} >
            Yes
        </button>
        <button className="px-[10px] bg-[red] text-[white] rounded-lg hover:bg-slate-600" onClick={()=> setPopUp(false)} >
            No
        </button>
    </div>}
</div>

            {/* Image Section */}
            <div className='w-full h-[65%] overflow-hidden relative rounded-xl'>
                <img 
                    src={image1} 
                    alt={title} 
                    className='w-full h-full object-cover group-hover:scale-110 transition-transform duration-500'
                    onError={(e) => { e.target.src = "https://images.unsplash.com/photo-1564013799919-ab600027ffc6?auto=format&fit=crop&w=800&q=80"; }} 
                />
                {isBooked && (
                    <div className='absolute top-2 right-2 bg-white/90 px-2 py-1 rounded-md text-green-700 text-xs font-bold shadow-sm'>
                        Booked
                    </div>
                )}
            </div>

            {/* Content Section */}
            <div className='w-full h-[35%] flex flex-col gap-1 px-1'>
                <div className='flex items-center justify-between'>
                    <h3 className='font-bold text-gray-800 text-lg truncate w-[70%] capitalize'>
                        {city}, {landMark}
                    </h3>
                    
                    <div className='flex items-center gap-1 text-sm'>
                        {ratings > 0 ? (
                            <>
                                <FaStar className='text-yellow-500' /> 
                                <span>{ratings}</span>
                            </>
                        ) : (
                            <>
                                <FaRegStar className='text-gray-400' />
                                <span className='text-gray-400 text-xs'>New</span>
                            </>
                        )}
                    </div>
                </div>
                
                <p className='text-gray-500 text-sm truncate capitalize'>{title}</p>
                
                <div className='mt-auto flex items-baseline gap-1'>
                    <span className='text-lg font-bold text-gray-900'>₹{rent && rent.toLocaleString()}</span>
                    <span className='text-gray-500 text-sm'>/ night</span>
                </div>
            </div>
        </div>
    );
}

export default Card;
"""

_____________________________________

--- frontend/src/Component/Nav.jsx ---

"""
import React, { useContext, useEffect, useState } from 'react'
import logo from '../assets/logo.png'
import { FiSearch } from "react-icons/fi";
import { GiHamburgerMenu } from "react-icons/gi";
import { CgProfile } from "react-icons/cg";
import { MdWhatshot } from "react-icons/md";
import { GiFamilyHouse } from "react-icons/gi";
import { MdBedroomParent } from "react-icons/md";
import { MdOutlinePool } from "react-icons/md";
import { GiWoodCabin } from "react-icons/gi";
import { SiHomeassistantcommunitystore } from "react-icons/si";
import { IoBedOutline } from "react-icons/io5";
import { FaK, FaTreeCity } from "react-icons/fa6";
import { BiBuildingHouse } from "react-icons/bi";
import { useNavigate } from 'react-router-dom';
import { authDataContext } from '../Context/AuthContext';
import axios from 'axios';
import { userDataContext } from '../Context/UserContext';
import { listingDataContext } from '../Context/ListingContext';
function Nav() {
    let [showpopup,setShowpopup]= useState(false)
    let {userData ,setUserData}= useContext(userDataContext)
    let navigate = useNavigate()
    let {serverUrl} = useContext(authDataContext)
    let [cate,setCate]= useState()
    let {listingData,setListingData,setNewListData,newListData,searchData,handleSearch,handleViewCard}=useContext(listingDataContext)
    let [input,setInput]=useState("")
    const handleLogOut = async () => {
        try {
            let result = await axios.post( serverUrl + "/api/auth/logout", {withCredentials:true})
            setUserData(null)

            console.log(result)
        } catch (error) {
            console.log(error)
        }
        
    }
    const handleCategory = (category)=>{
       setCate(category)
       if(category=="trending"){
        setNewListData(listingData)
       }
       else{
       setNewListData(listingData.filter((list)=>list.category==category))}

       

    }
    const handleClick = (id) => {
        if (userData) {
            handleViewCard(id)
        }
        else {
            navigate("/login")
        }
    }
    useEffect(()=>{
      handleSearch(input)
    },[input])

    return (

        <div className='fixed top-0 bg-[white] z-[20]'>
            <div className='w-[100vw] min-h-[80px]  border-b-[1px] border-[#dcdcdc] px-[20px] flex items-center justify-between md:px-[40px] '>
                <div><img src={logo} alt="" className='w-[130px]' /></div>

                <div className='w-[35%] relative hidden md:block '>
                    <input type="text" className='w-[100%] px-[30px] py-[10px] border-[2px] border-[#bdbaba] outline-none overflow-auto rounded-[30px] text-[17px]' placeholder='Any Where  |  Any Location  |  Any City 'onChange={(e)=>setInput(e.target.value)} value={input}/>
                    <button className='absolute p-[10px] rounded-[50px] bg-[red] right-[3%] top-[5px]'><FiSearch className='w-[20px] h-[20px] text-[white]' /></button>
                </div>
                <div className='flex items-center justify-center    gap-[10px] relative'>
                    <span className='text-[18px] cursor-pointer rounded-[50px] hover:bg-[#ded9d9] px-[8px] py-[5px] hidden md:block' onClick={()=>navigate("/listingpage1")}>List your home</span>
                    <button className='px-[20px] py-[10px] flex items-center justify-center gap-[5px] border-[1px] border-[#8d8c8c] rounded-[50px] hover:shadow-lg' onClick={()=>setShowpopup(prev =>!prev)}>
                        <span><GiHamburgerMenu className='w-[20px] h-[20px]' /></span>
                        {userData == null && <span><CgProfile className='w-[23px] h-[23px]' /></span>}
                        {userData != null && <span className='w-[30px] h-[30px] bg-[#080808] text-[white] rounded-full flex items-center justify-center'>{userData?.name.slice(0,1)}</span>}
                    </button>
                    {showpopup && <div className='w-[220px] h-[250px] absolute bg-slate-50 top-[110%] right-[3%] border-[1px] border-[#aaa9a9] z-10 rounded-lg md:right-[10%]'>
                        <ul className='w-[100%] h-[100%] text-[17px] flex items-start justify-around flex-col py-[10px]'>
                            {!userData && <li className='w-[100%] px-[15px] py-[10px] hover:bg-[#f4f3f3] cursor-pointer' onClick={()=>{navigate("/login");setShowpopup(false)}}>Login</li>}
                            {userData && <li className='w-[100%] px-[15px] py-[10px] hover:bg-[#f4f3f3] cursor-pointer' onClick={()=>{handleLogOut();setShowpopup(false)}}>Logout</li>}
                            <div className='w-[100%] h-[1px] bg-[#c1c0c0]'></div>
                            <li className='w-[100%] px-[15px] py-[10px] hover:bg-[#f4f3f3] cursor-pointer' onClick={()=>{navigate("/listingpage1");setShowpopup(false)}}>List your Home</li>
                            <li className='w-[100%] px-[15px] py-[10px] hover:bg-[#f4f3f3] cursor-pointer'onClick={()=>{navigate("/mylisting");setShowpopup(false)}}>My Listing</li>
                            <li className='w-[100%] px-[15px] py-[10px] hover:bg-[#f4f3f3] cursor-pointer'  onClick={()=>{navigate("/mybooking");setShowpopup(false)}}>MY Booking</li>
                        </ul>

                    </div>}
                </div>

            
               {searchData?.length>0 && <div className='w-[100vw] h-[450px]  flex flex-col gap-[20px] absolute top-[50%]  overflow-auto left-[0]   justify-start  items-center'>
                    <div className='max-w-[700px] w-[100vw] h-[300px] overflow-hidden  flex flex-col bg-[#fefdfd] p-[20px] rounded-lg border-[1px] border-[#a2a1a1] cursor-pointer'>
                        {
                            searchData.map((search)=>(
                            <div className='border-b border-[black] p-[10px]' onClick={()=>handleClick(search._id)}>
                                {search.title} in {search.landMark},{search.city}
                                 </div>
                            ))

                        }
                    </div>
                </div>}
               
               

            </div>
            <div className='w-[100%] h-[60px] flex items-center justify-center  md:hidden 
            '>
                <div className='w-[80%] relative '>
                    <input type="text" className='w-[100%] px-[30px] py-[10px] border-[2px] border-[#bdbaba] outline-none overflow-auto rounded-[30px] text-[17px]' placeholder='Any Where  |  Any Location  |  Any City ' onChange={(e)=>setInput(e.target.value)} value={input} />
                    <button className='absolute p-[10px] rounded-[50px] bg-[red] right-[3%] top-[5px]'><FiSearch className='w-[20px] h-[20px] text-[white]' /></button>
                </div>
                </div>

          
           
                

            <div className='w-[100vw] h-[85px] bg-white flex items-center justify-start cursor-pointer gap-[40px] overflow-auto md:justify-center px-[15px] '>
                <div className='flex items-center justify-center flex-col hover:border-b-[1px] border-[#a6a5a5] text-[13px]' onClick={()=>{handleCategory("trending")
                    setCate("")}}>
                    <MdWhatshot className='w-[30px] h-[30px] text-black' />
                    <h3>Trending</h3>
                </div>

                <div className={`flex items-center justify-center flex-col hover:border-b-[1px] border-[#a6a5a5] text-[13px] ${cate=="villa"?"border-b-[1px] border-[#a6a5a5]":""}`} onClick={()=>handleCategory("villa")}>
                    <GiFamilyHouse className='w-[30px] h-[30px] text-black' />
                    <h3>Villa</h3>

                </div>

                <div className={`flex items-center justify-center flex-col hover:border-b-[1px] border-[#a6a5a5] text-[13px] ${cate=="farmHouse"?"border-b-[1px] border-[#a6a5a5]":""}`} onClick={()=>handleCategory("farmHouse")}>
                    <FaTreeCity className='w-[30px] h-[30px] text-black' />
                    <h3>Farm House</h3>

                </div>

                <div className={`flex items-center justify-center flex-col hover:border-b-[1px] border-[#a6a5a5] text-[13px] ${cate=="poolHouse"?"border-b-[1px] border-[#a6a5a5]":""}`} onClick={()=>handleCategory("poolHouse")}>
                    <MdOutlinePool className='w-[30px] h-[30px] text-black' />
                    <h3>Pool House</h3>

                </div>

                <div className={`flex items-center justify-center flex-col hover:border-b-[1px] border-[#a6a5a5] text-[13px] ${cate=="rooms"?"border-b-[1px] border-[#a6a5a5]":""}`} onClick={()=>handleCategory("rooms")}>
                    <MdBedroomParent className='w-[30px] h-[30px] text-black' />
                    <h3>Rooms</h3>

                </div>

                <div className={`flex items-center justify-center flex-col hover:border-b-[1px] border-[#a6a5a5] text-[13px] ${cate=="flat"?"border-b-[1px] border-[#a6a5a5]":""}`} onClick={()=>handleCategory("flat")}>
                    <BiBuildingHouse className='w-[30px] h-[30px] text-black' />
                    <h3>Flat</h3>

                </div>

                <div className={`flex items-center justify-center flex-col hover:border-b-[1px] border-[#a6a5a5] text-[13px] ${cate=="pg"?"border-b-[1px] border-[#a6a5a5]":""}`} onClick={()=>handleCategory("pg")}>
                    <IoBedOutline className='w-[30px] h-[30px] text-black' />
                    <h3>PG</h3>

                </div>

                <div className={`flex items-center justify-center flex-col hover:border-b-[1px] border-[#a6a5a5] text-[13px] ${cate=="cabin"?"border-b-[1px] border-[#a6a5a5]":""}`} onClick={()=>handleCategory("cabin")}>
                    <GiWoodCabin className='w-[30px] h-[30px] text-black' />
                    <h3>Cabins</h3>

                </div>

                <div className={`flex items-center justify-center flex-col hover:border-b-[1px] border-[#a6a5a5] text-[13px] ${cate=="shops"?"border-b-[1px] border-[#a6a5a5]":""}`} onClick={()=>handleCategory("shops")}>
                    <SiHomeassistantcommunitystore className='w-[30px] h-[30px] text-black' />
                    <h3>Shops</h3>

                </div>


            </div>
        </div>
    )
}

export default Nav
"""

_____________________________________

--- frontend/src/Component/Star.jsx ---
"""
import React, { useState } from 'react'
import { FaStar } from "react-icons/fa";

function Star({starValue = 5 , onRate}) {
    let [rating,setRating]=useState(0)
    let [hover,setHover]=useState(0)
  return (
    <div className=' flex gap-1'>
        {
         [...Array(starValue)].map((_,index)=>
            {
            const starValue = index + 1;
            const isFilled = starValue <=
            (hover || rating);

            return (
                <span key={starValue}
                onClick={()=>{
                    setRating(starValue)
                    onRate && onRate(starValue)
                }}
                onMouseEnter={()=>setHover(starValue)}

                onMouseLeave={()=>setHover(0)}


                >
             <FaStar className={`cursor-pointer text-2xl ${isFilled? "text-yellow-400":"'text-gray-400"} `}/>
                </span>
            )
            
         }
) 
        }


      
    </div>
  )
}

export default Star
"""
_____________________________________

--- frontend/src/Context/AuthContext.jsx ---
"""
import React, { createContext, useState } from 'react'

export const authDataContext = createContext()

function AuthContext({children}) {
    const serverUrl = "http://localhost:8000"
    let [loading, setLoading] = useState(false)

    let value = {
        serverUrl,
        loading, 
        setLoading
    }

    return (
        <authDataContext.Provider value={value}>
            {children}
        </authDataContext.Provider>
    )
}

export default AuthContext
"""
_____________________________________

--- frontend/src/Context/BookingContext.jsx ---
"""
import axios from 'axios'
import React, { createContext, useContext, useState } from 'react'
import { authDataContext } from './AuthContext'
import { userDataContext } from './UserContext'
import { listingDataContext } from './ListingContext'
import { useNavigate } from 'react-router-dom'
import { toast } from 'react-toastify';
let [bookingData, setBookingData] = useState([])
export const bookingDataContext = createContext()

function BookingContext({ children }) {
    const [checkIn, setCheckIn] = useState("")
    const [checkOut, setCheckOut] = useState("")
    const [total, setTotal] = useState(0)
    const [night, setNight] = useState(0)
    let navigate = useNavigate()  
    // Consuming other contexts
    const { serverUrl } = useContext(authDataContext)
    const { getCurrentUser } = useContext(userDataContext)
    const { getListing } = useContext(listingDataContext)
    
    const [bookingData, setBookingData] = useState([])
    const [booking, setBooking] = useState(false)
    // const navigate = useNavigate()

    const handleBooking = async (id) => {
        setBooking(true)
        try {
            let result = await axios.post(`${serverUrl}/api/booking/create/${id}`, {
                checkIn, checkOut, totalRent: total
            }, { withCredentials: true })
            
            await getCurrentUser()
            await getListing()
            setBookingData(result.data)
            console.log(result.data)
            setBooking(false)
            navigate("/booked") // Make sure this route exists in App.jsx!
            toast.success("Booking Successful")

        } catch (error) {
            console.log(error)
            setBookingData(null)
            toast.error(error.response?.data?.message || "Booking Failed")
            setBooking(false)
        }
    }

    // const cancelBooking = async (id) => {
    //     try {
    //         let result = await axios.delete(`${serverUrl}/api/booking/cancel/${id}`, { withCredentials: true })
    //         await getCurrentUser()
    //         await getListing()
    //         console.log(result.data)
    //         toast.success("Booking Cancelled Successfully")
    //     } catch (error) {
    //         console.log(error)
    //         toast.error(error.response?.data?.message || "Cancellation Failed")
    //     }
    // }

    // this above code was alredady written but i had no idea if it is correct or the below one..so keeping it for gemini's reference.

    const cancelBooking = async (id) => {
        try {
            let result = await axios.delete(`${serverUrl}/api/booking/cancel/${id}`, { withCredentials: true })
            await getCurrentUser()
            await getListing()
            console.log(result.data)
            toast.success("Booking Cancelled Successfully")
        } catch (error) {
            console.log(error)
            toast.error(error.response?.data?.message || "Cancellation Failed")
        }
        await getCurrentUser()
        await getListing()
        console.log(result.data)
        toast.success("Booking Cancelled Successfully")
    }


    const value = {
        checkIn, setCheckIn,
        checkOut, setCheckOut,
        total, setTotal,
        night, setNight,
        bookingData, setBookingData,
        handleBooking, cancelBooking, booking, setBooking
    }

    return (
        <bookingDataContext.Provider value={value}>
            {children}
        </bookingDataContext.Provider>
    )
}

export default BookingContext

"""

_____________________________________

--- frontend/src/Context/ListingContext.jsx ---

"""
import axios from 'axios'
import React, { createContext, useContext, useEffect, useState } from 'react'
import { authDataContext } from './AuthContext'
import { useNavigate } from 'react-router-dom'
import { toast } from 'react-toastify';

export const listingDataContext = createContext()

function ListingContext({children}) {
    let navigate = useNavigate() 
    let { serverUrl } = useContext(authDataContext)

    // Form States
    let [title, setTitle] = useState("")
    let [description, setDescription] = useState("")
    let [frontEndImage1, setFrontEndImage1] = useState(null)
    let [frontEndImage2, setFrontEndImage2] = useState(null)
    let [frontEndImage3, setFrontEndImage3] = useState(null)
    let [backEndImage1, setBackEndImage1] = useState(null)
    let [backEndImage2, setBackEndImage2] = useState(null)
    let [backEndImage3, setBackEndImage3] = useState(null)
    let [rent, setRent] = useState("")
    let [city, setCity] = useState("")
    let [landmark, setLandmark] = useState("")
    let [category, setCategory] = useState("")

    // --- NEW STATES FOR COUNTERS ---
    let [guestCount, setGuestCount] = useState(1)
    let [bedroomCount, setBedroomCount] = useState(1)
    let [bathroomCount, setBathroomCount] = useState(1)
    // -------------------------------

    // Status States
    let [adding, setAdding] = useState(false)
    let [updating, setUpdating] = useState(false)
    let [deleting, setDeleting] = useState(false)

    // Data States
    let [listingData, setListingData] = useState([])
    let [newListData, setNewListData] = useState([])
    let [cardDetails, setCardDetails] = useState(null)
    let [searchData, setSearchData] = useState([])

    const handleAddListing = async () => {
        setAdding(true)
        try {
            let formData = new FormData()
            formData.append("title", title)
            formData.append("image1", backEndImage1)
            formData.append("image2", backEndImage2)
            formData.append("image3", backEndImage3)
            formData.append("description", description)
            formData.append("rent", rent)
            formData.append("city", city)
            formData.append("landmark", landmark)
            formData.append("category", category)
            
            // --- APPEND NEW FIELDS ---
            formData.append("guestCapacity", guestCount)
            formData.append("bedroomCount", bedroomCount)
            formData.append("bathroomCount", bathroomCount)
            // -------------------------
        
            let result = await axios.post(`${serverUrl}/api/listing/add`, formData, { withCredentials: true })
            
            setAdding(false)
            toast.success("Listing Added Successfully")
            
            // Reset Form
            setTitle(""); setDescription(""); setRent(""); setCity(""); setLandmark(""); setCategory("");
            setFrontEndImage1(null); setFrontEndImage2(null); setFrontEndImage3(null);
            setBackEndImage1(null); setBackEndImage2(null); setBackEndImage3(null);
            // Reset counters
            setGuestCount(1); setBedroomCount(1); setBathroomCount(1);

            navigate("/")
        } catch (error) {
            setAdding(false)
            console.error(error)
            toast.error(error.response?.data?.message || "Failed to add listing")
        }
    }

    const handleViewCard = async (id) => {
        try {
            let result = await axios.get(`${serverUrl}/api/listing/findlistingByid/${id}`, { withCredentials: true })
            setCardDetails(result.data)
            navigate("/viewcard")
        } catch (error) {
            console.error(error)
        }
    }

    const handleDeleteListing = async (id) => {
        setDeleting(true);
        try {
            await axios.delete(`${serverUrl}/api/listing/delete/${id}`, { withCredentials: true });
            toast.success("Listing Deleted Successfully");
            setDeleting(false);
            getListing();
        } catch (error) {
            setDeleting(false);
            console.error(error);
            toast.error("Failed to delete");
        }
    }

    const handleSearch = async (data) => {
        if (!data) {
            setSearchData([])
            return
        }
        try {
            let result = await axios.get(`${serverUrl}/api/listing/search?query=${data}`)
            setSearchData(result.data)
        } catch (error) {
            setSearchData(null)
            console.error(error)
        }
    }

    const getListing = async () => {
        try {
            let result = await axios.get(`${serverUrl}/api/listing/get`, { withCredentials: true })
            setListingData(result.data)
            setNewListData(result.data)
        } catch (error) {
            console.error(error)
        }
    }

    useEffect(() => {
        getListing()
    }, [adding, updating, deleting])

    let value = {
        title, setTitle,
        description, setDescription,
        frontEndImage1, setFrontEndImage1,
        frontEndImage2, setFrontEndImage2,
        frontEndImage3, setFrontEndImage3,
        backEndImage1, setBackEndImage1,
        backEndImage2, setBackEndImage2,
        backEndImage3, setBackEndImage3,
        rent, setRent,
        city, setCity,
        landmark, setLandmark,
        category, setCategory,
        // New Exports
        guestCount, setGuestCount,
        bedroomCount, setBedroomCount,
        bathroomCount, setBathroomCount,
        // -----------
        handleAddListing,
        adding, setAdding,
        listingData, setListingData,
        getListing,
        newListData, setNewListData,
        handleViewCard,
        cardDetails, setCardDetails,
        updating, setUpdating,
        deleting, setDeleting,
        handleSearch, searchData, setSearchData,
        handleDeleteListing
    }

    return (
        <listingDataContext.Provider value={value}>
            {children}
        </listingDataContext.Provider>
    )
}

export default ListingContext
"""

_____________________________________

--- frontend/src/Context/UserContext.jsx ---

"""
import React, { createContext, useEffect, useState, useContext } from 'react'
import { authDataContext } from './AuthContext' 
import axios from 'axios'

export const userDataContext = createContext()

function UserContext({children}) {
    // We add a default value here just in case AuthContext isn't ready
    const authData = useContext(authDataContext)
    const serverUrl = authData ? authData.serverUrl : "http://localhost:8000"
    
    let [userData, setUserData] = useState(null)

    const getCurrentUser = async () => {
        try {
            let result = await axios.get(`${serverUrl}/api/user/currentuser`, { withCredentials: true })
            setUserData(result.data)
        } catch (error) {
            setUserData(null)
        }
    }

    useEffect(() =>{
    },[])

    let value = {
        userData,
        setUserData,
        getCurrentUser
    }

    return (
        <userDataContext.Provider value={value}>
            {children}
        </userDataContext.Provider>
    )
}

export default UserContext
"""
_____________________________________

--- frontend/src/pages/Booked.jsx ---

"""
import React, { useContext, useState } from 'react'
import { GiConfirmed } from "react-icons/gi";
import { bookingDataContext } from '../Context/BookingContext';

import { useNavigate } from 'react-router-dom';
import Star from '../Component/Star';

import UserContext, { userDataContext } from '../Context/UserContext';
import { authDataContext } from '../Context/AuthContext';
import { listingDataContext } from '../Context/ListingContext';
import axios from 'axios';

function Booked() {
    let {bookingData} = useContext(bookingDataContext)
    let [star,setStar]= useState(null)
    let {serverUrl} = useContext(authDataContext) 
    let {getCurrentUser}= useContext(userDataContext)
    let {getListing,cardDetails} = useContext(listingDataContext)
   
    
    let navigate = useNavigate()
   
    const handleRating=async (id)=>{
        try {
          let result=await axios.post(serverUrl+`/api/listing/ratings/${id}`,{
            ratings:star
          },{withCredentials:true})
          await getListing()
          await getCurrentUser()
        
          console.log(result);
          navigate("/")
          
        } catch (error) {
          console.log(error)
        }
        }



    const handleStar=async (value) => {
        setStar(value)
        console.log("you rated",value )

        
    }

  
  return (
    <div className='w-[100vw] min-h-[100vh] flex items-center justify-center gap-[10px] bg-slate-200 flex-col'>
        <div className='w-[95%] max-w-[500px] h-[400px] bg-[white] flex items-center justify-center border-[1px] border-[#b5b5b5] flex-col gap-[20px] p-[20px] md:w-[80%] rounded-lg'>
            <div className='w-[100%] h-[50%] text-[20px] flex items-center justify-center flex-col gap-[20px] font-semibold'><GiConfirmed className='w-[100px] h-[100px] text-[green]' />Booking Confirmed</div>
            <div className='w-[100%] flex items-center justify-between text-[16px] md:text-[18px] '><span>Booking Id :</span> <span>{bookingData._id}</span></div>
            <div className='w-[100%] flex items-center justify-between text-[16px] md:text-[18px] '><span>Owner Details :</span> <span>{bookingData.host?.email}</span></div>
            <div className='w-[100%] flex items-center justify-between text-[16px] md:text-[18px] '><span>Total Rent :</span> <span>{bookingData.totalRent}</span></div>
        </div>

        <div className='w-[95%] max-w-[600px] h-[200px] bg-[white] flex items-center justify-center border-[1px] border-[#b5b5b5] flex-col gap-[20px] p-[20px] md:w-[80%] rounded-lg'>
            <h1 className='text-[18px]'> {star} out of 5 Rating</h1>
         <Star onRate={handleStar}/>
         <button className='px-[30px] py-[10px] bg-[red] text-[white] text-[18px] md:px-[100px] rounded-lg text-nowrap ' onClick={()=>handleRating(cardDetails._id)}>Submit</button>
        </div>
        <button className='px-[30px] py-[10px] bg-[red] text-[white] text-[18px] md:px-[100px] rounded-lg text-nowrap absolute top-[10px] right-[20px]'onClick={()=>navigate("/")}>Back to Home</button>
      
    </div>
  )
}

export default Booked
"""
_____________________________________

import React, { useContext } from 'react'
import Nav from '../Component/Nav'
import Card from '../Component/Card' 
import { listingDataContext } from '../Context/ListingContext'

function Home() {
  const context = useContext(listingDataContext) || {};
  const { newListData = [] } = context; 

  return (
    <div className='w-full min-h-screen bg-gray-50'>
      <Nav />
      
      
<div className='w-full max-w-[1400px] mx-auto flex items-start justify-center gap-6 flex-wrap pt-[230px] md:pt-[200px] px-6 pb-20'>        
        {newListData.length > 0 ? (
          newListData.map((list) => (
            // Inside your map function in HomePage.jsx
<Card 
    key={list._id}
    id={list._id}
    title={list.title}
    city={list.city}
    landMark={list.landmark} 
    rent={list.rent}
    image1={list.image1}
    image2={list.image2}
    image3={list.image3} 
    isBooked={list.isBooked}
    host={list.host}
    
    // CHANGE: Pass the real rating. If it doesn't exist, it defaults to 0.
    ratings={list.averageRating || 0} 
    
    isBooked={false} 
/>
          ))
        ) : (
          <div className="flex flex-col items-center justify-center mt-20 text-center space-y-4">
            <div className="w-20 h-20 bg-gray-200 rounded-full flex items-center justify-center text-3xl">🏠</div>
            <h2 className="text-2xl font-bold text-gray-700">No Listings Yet</h2>
            <p className="text-gray-500 max-w-md">
                It looks like our database is empty. Be the first host to publish a luxury flat!
            </p>
          </div>
        )}

      </div>
    </div> 
  )
}

export default Home
"""
_____________________________________

--- frontend/src/pages/HomePage.jsx ---

"""
import React, { useContext } from 'react';
import { FaLongArrowAltLeft, FaTimes } from "react-icons/fa"; 
import { useNavigate } from 'react-router-dom';
import { listingDataContext } from '../Context/ListingContext';

function ListingPage1() {
    let navigate = useNavigate();
    let {
        title, setTitle,
        description, setDescription,
        setFrontEndImage1, setFrontEndImage2, setFrontEndImage3,
        backEndImage1, setBackEndImage1, 
        backEndImage2, setBackEndImage2, 
        backEndImage3, setBackEndImage3,
        rent, setRent,
        city, setCity,
        landmark, setLandmark,
        frontEndImage1, frontEndImage2, frontEndImage3 // Needed to check for required files
    } = useContext(listingDataContext);

    const handleImageChange = (e, setBack, setFront) => {
        const file = e.target.files[0];
        if (file) {
            setBack(file);
            setFront(URL.createObjectURL(file));
        }
    };

    const removeImage = (e, setBack, setFront) => {
        e.stopPropagation();
        setBack(null);
        setFront(null);
    };

    const imageSlots = [
        { id: 1, back: backEndImage1, front: frontEndImage1, setBack: setBackEndImage1, setFront: setFrontEndImage1 },
        { id: 2, back: backEndImage2, front: frontEndImage2, setBack: setBackEndImage2, setFront: setFrontEndImage2 },
        { id: 3, back: backEndImage3, front: frontEndImage3, setBack: setBackEndImage3, setFront: setFrontEndImage3 },
    ];

    return (
        <div className='w-full min-h-screen bg-white flex flex-col items-center py-10 px-4 relative'>
            <div className="w-full max-w-[900px] flex items-center justify-between mb-8">
                <div 
                    className='w-12 h-12 bg-red-600 cursor-pointer rounded-full flex items-center justify-center hover:bg-red-700 transition-all shadow-md' 
                    onClick={() => navigate("/")}
                >
                    <FaLongArrowAltLeft className='w-6 h-6 text-white' />
                </div>
                <div className='bg-black text-white px-6 py-2 rounded-full text-sm font-semibold shadow-sm'>
                    Step 1 of 2: Basics
                </div>
            </div>

            <form 
                className='max-w-[700px] w-full flex flex-col gap-6' 
                onSubmit={(e) => {
                    e.preventDefault();
                    navigate("/listingpage2");
                }}
            >
                <h1 className='text-3xl font-bold text-gray-800 mb-2'>List your property</h1>
                
                <div className='flex flex-col gap-2'>
                    <label className='text-lg font-semibold text-gray-700'>Property Title</label>
                    <input 
                        type="text" 
                        className='w-full h-12 border-2 border-gray-200 rounded-xl px-4 focus:border-red-500 outline-none transition-all' 
                        required 
                        onChange={(e) => setTitle(e.target.value)} 
                        value={title} 
                        placeholder='e.g., Cozy 2BHK near Beach'
                    />
                </div>

                <div className='flex flex-col gap-2'>
                    <label className='text-lg font-semibold text-gray-700'>Description</label>
                    <textarea 
                        className='w-full h-32 border-2 border-gray-200 rounded-xl px-4 py-3 focus:border-red-500 outline-none transition-all resize-none' 
                        required 
                        onChange={(e) => setDescription(e.target.value)} 
                        value={description}
                        placeholder='Tell guests what makes your place special...'
                    ></textarea>
                </div>

                <div className='grid grid-cols-1 md:grid-cols-3 gap-4'>
                    {imageSlots.map((slot) => (
                        <div key={slot.id} className='flex flex-col gap-2'>
                            <label className='text-sm font-medium text-gray-600'>Image {slot.id}</label>
                            <div className={`relative w-full h-14 border-2 border-dashed rounded-xl flex items-center justify-center transition-all cursor-pointer
                                ${slot.back ? 'border-red-500 bg-gray-100 shadow-inner' : 'border-gray-300 hover:bg-gray-50'}`}>
                                <input 
                                    type="file" 
                                    className='absolute inset-0 opacity-0 cursor-pointer z-10' 
                                    required={slot.id === 1 && !slot.back} // Only first image is strictly required for preview
                                    onChange={(e) => handleImageChange(e, slot.setBack, slot.setFront)}
                                />
                                {slot.back ? (
                                    <div className='flex items-center justify-between w-full px-3 z-20'>
                                        <span className='text-[10px] text-red-600 truncate font-bold w-[80%]'>
                                            {slot.back.name}
                                        </span>
                                        <button 
                                            type="button"
                                            onClick={(e) => removeImage(e, slot.setBack, slot.setFront)}
                                            className='bg-red-600 text-white rounded-full p-1 hover:bg-red-800 transition-colors'
                                        >
                                            <FaTimes size={10}/>
                                        </button>
                                    </div>
                                ) : (
                                    <span className='text-xs text-gray-400 pointer-events-none font-medium'>Upload Photo</span>
                                )}
                            </div>
                        </div>
                    ))}
                </div>

                <div className='grid grid-cols-1 md:grid-cols-2 gap-6'>
                    <div className='flex flex-col gap-2'>
                        <label className='text-lg font-semibold text-gray-700'>Rent per Night</label>
                        <input 
                            type="number" 
                            className='w-full h-12 border-2 border-gray-200 rounded-xl px-4 focus:border-red-500 outline-none transition-all' 
                            required 
                            onChange={(e) => setRent(e.target.value)} 
                            value={rent} 
                            placeholder='₹ Amount'
                        />
                    </div>
                    <div className='flex flex-col gap-2'>
                        <label className='text-lg font-semibold text-gray-700'>City</label>
                        <input 
                            type="text" 
                            className='w-full h-12 border-2 border-gray-200 rounded-xl px-4 focus:border-red-500 outline-none transition-all' 
                            required 
                            onChange={(e) => setCity(e.target.value)} 
                            value={city} 
                            placeholder='Nashik, India'
                        />
                    </div>
                </div>

                <div className='flex flex-col gap-2'>
                    <label className='text-lg font-semibold text-gray-700'>Landmark</label>
                    <input 
                        type="text" 
                        className='w-full h-12 border-2 border-gray-200 rounded-xl px-4 focus:border-red-500 outline-none transition-all' 
                        required 
                        onChange={(e) => setLandmark(e.target.value)} 
                        value={landmark}
                        placeholder='e.g., Near Vidya Vikas Circle'
                    />
                </div>

                <button className='w-full bg-red-600 text-white py-4 rounded-xl text-xl font-bold hover:bg-red-700 transition-all shadow-lg mt-4'>
                    Next Step
                </button>
            </form>
        </div>
    );
}

export default ListingPage1;

"""
_____________________________________

--- frontend/src/pages/ListingPage1.jsx ---
"""
import React, { useContext } from 'react';
import { FaLongArrowAltLeft, FaTimes } from "react-icons/fa"; 
import { useNavigate } from 'react-router-dom';
import { listingDataContext } from '../Context/ListingContext';

function ListingPage1() {
    let navigate = useNavigate();
    let {
        title, setTitle,
        description, setDescription,
        setFrontEndImage1, setFrontEndImage2, setFrontEndImage3,
        backEndImage1, setBackEndImage1, 
        backEndImage2, setBackEndImage2, 
        backEndImage3, setBackEndImage3,
        rent, setRent,
        city, setCity,
        landmark, setLandmark,
        frontEndImage1, frontEndImage2, frontEndImage3 // Needed to check for required files
    } = useContext(listingDataContext);

    const handleImageChange = (e, setBack, setFront) => {
        const file = e.target.files[0];
        if (file) {
            setBack(file);
            setFront(URL.createObjectURL(file));
        }
    };

    const removeImage = (e, setBack, setFront) => {
        e.stopPropagation();
        setBack(null);
        setFront(null);
    };

    const imageSlots = [
        { id: 1, back: backEndImage1, front: frontEndImage1, setBack: setBackEndImage1, setFront: setFrontEndImage1 },
        { id: 2, back: backEndImage2, front: frontEndImage2, setBack: setBackEndImage2, setFront: setFrontEndImage2 },
        { id: 3, back: backEndImage3, front: frontEndImage3, setBack: setBackEndImage3, setFront: setFrontEndImage3 },
    ];

    return (
        <div className='w-full min-h-screen bg-white flex flex-col items-center py-10 px-4 relative'>
            <div className="w-full max-w-[900px] flex items-center justify-between mb-8">
                <div 
                    className='w-12 h-12 bg-red-600 cursor-pointer rounded-full flex items-center justify-center hover:bg-red-700 transition-all shadow-md' 
                    onClick={() => navigate("/")}
                >
                    <FaLongArrowAltLeft className='w-6 h-6 text-white' />
                </div>
                <div className='bg-black text-white px-6 py-2 rounded-full text-sm font-semibold shadow-sm'>
                    Step 1 of 2: Basics
                </div>
            </div>

            <form 
                className='max-w-[700px] w-full flex flex-col gap-6' 
                onSubmit={(e) => {
                    e.preventDefault();
                    navigate("/listingpage2");
                }}
            >
                <h1 className='text-3xl font-bold text-gray-800 mb-2'>List your property</h1>
                
                <div className='flex flex-col gap-2'>
                    <label className='text-lg font-semibold text-gray-700'>Property Title</label>
                    <input 
                        type="text" 
                        className='w-full h-12 border-2 border-gray-200 rounded-xl px-4 focus:border-red-500 outline-none transition-all' 
                        required 
                        onChange={(e) => setTitle(e.target.value)} 
                        value={title} 
                        placeholder='e.g., Cozy 2BHK near Beach'
                    />
                </div>

                <div className='flex flex-col gap-2'>
                    <label className='text-lg font-semibold text-gray-700'>Description</label>
                    <textarea 
                        className='w-full h-32 border-2 border-gray-200 rounded-xl px-4 py-3 focus:border-red-500 outline-none transition-all resize-none' 
                        required 
                        onChange={(e) => setDescription(e.target.value)} 
                        value={description}
                        placeholder='Tell guests what makes your place special...'
                    ></textarea>
                </div>

                <div className='grid grid-cols-1 md:grid-cols-3 gap-4'>
                    {imageSlots.map((slot) => (
                        <div key={slot.id} className='flex flex-col gap-2'>
                            <label className='text-sm font-medium text-gray-600'>Image {slot.id}</label>
                            <div className={`relative w-full h-14 border-2 border-dashed rounded-xl flex items-center justify-center transition-all cursor-pointer
                                ${slot.back ? 'border-red-500 bg-gray-100 shadow-inner' : 'border-gray-300 hover:bg-gray-50'}`}>
                                <input 
                                    type="file" 
                                    className='absolute inset-0 opacity-0 cursor-pointer z-10' 
                                    required={slot.id === 1 && !slot.back} // Only first image is strictly required for preview
                                    onChange={(e) => handleImageChange(e, slot.setBack, slot.setFront)}
                                />
                                {slot.back ? (
                                    <div className='flex items-center justify-between w-full px-3 z-20'>
                                        <span className='text-[10px] text-red-600 truncate font-bold w-[80%]'>
                                            {slot.back.name}
                                        </span>
                                        <button 
                                            type="button"
                                            onClick={(e) => removeImage(e, slot.setBack, slot.setFront)}
                                            className='bg-red-600 text-white rounded-full p-1 hover:bg-red-800 transition-colors'
                                        >
                                            <FaTimes size={10}/>
                                        </button>
                                    </div>
                                ) : (
                                    <span className='text-xs text-gray-400 pointer-events-none font-medium'>Upload Photo</span>
                                )}
                            </div>
                        </div>
                    ))}
                </div>

                <div className='grid grid-cols-1 md:grid-cols-2 gap-6'>
                    <div className='flex flex-col gap-2'>
                        <label className='text-lg font-semibold text-gray-700'>Rent per Night</label>
                        <input 
                            type="number" 
                            className='w-full h-12 border-2 border-gray-200 rounded-xl px-4 focus:border-red-500 outline-none transition-all' 
                            required 
                            onChange={(e) => setRent(e.target.value)} 
                            value={rent} 
                            placeholder='₹ Amount'
                        />
                    </div>
                    <div className='flex flex-col gap-2'>
                        <label className='text-lg font-semibold text-gray-700'>City</label>
                        <input 
                            type="text" 
                            className='w-full h-12 border-2 border-gray-200 rounded-xl px-4 focus:border-red-500 outline-none transition-all' 
                            required 
                            onChange={(e) => setCity(e.target.value)} 
                            value={city} 
                            placeholder='Nashik, India'
                        />
                    </div>
                </div>

                <div className='flex flex-col gap-2'>
                    <label className='text-lg font-semibold text-gray-700'>Landmark</label>
                    <input 
                        type="text" 
                        className='w-full h-12 border-2 border-gray-200 rounded-xl px-4 focus:border-red-500 outline-none transition-all' 
                        required 
                        onChange={(e) => setLandmark(e.target.value)} 
                        value={landmark}
                        placeholder='e.g., Near Vidya Vikas Circle'
                    />
                </div>

                <button className='w-full bg-red-600 text-white py-4 rounded-xl text-xl font-bold hover:bg-red-700 transition-all shadow-lg mt-4'>
                    Next Step
                </button>
            </form>
        </div>
    );
}

export default ListingPage1;
"""
_____________________________________
--- frontend/src/pages/ListingPage2.jsx ---

"""
import React, { useContext } from 'react';
import { FaLongArrowAltLeft, FaMinus, FaPlus } from "react-icons/fa";
import { useNavigate } from 'react-router-dom';
import { MdWhatshot, MdBedroomParent, MdOutlinePool } from "react-icons/md";
import { GiFamilyHouse, GiWoodCabin } from "react-icons/gi";
import { SiHomeassistantcommunitystore } from "react-icons/si";
import { IoBedOutline } from "react-icons/io5";
import { FaTreeCity } from "react-icons/fa6";
import { BiBuildingHouse } from "react-icons/bi";
import { listingDataContext } from '../Context/ListingContext';

function ListingPage2() {
    const navigate = useNavigate();
    const { 
        category, setCategory,
        guestCount, setGuestCount,
        bedroomCount, setBedroomCount,
        bathroomCount, setBathroomCount
    } = useContext(listingDataContext);

    const categories = [
        { id: "trending", label: "Trending", icon: <MdWhatshot size={28} /> },
        { id: "villa", label: "Villa", icon: <GiFamilyHouse size={28} /> },
        { id: "farmHouse", label: "Farm House", icon: <FaTreeCity size={28} /> },
        { id: "poolHouse", label: "Pool House", icon: <MdOutlinePool size={28} /> },
        { id: "rooms", label: "Rooms", icon: <MdBedroomParent size={28} /> },
        { id: "flat", label: "Flat", icon: <BiBuildingHouse size={28} /> },
        { id: "pg", label: "PG", icon: <IoBedOutline size={28} /> },
        { id: "cabin", label: "Cabin", icon: <GiWoodCabin size={28} /> },
        { id: "shops", label: "Shops", icon: <SiHomeassistantcommunitystore size={28} /> },
    ];

    // Helper for counters
    const Counter = ({ label, value, setValue }) => (
        <div className='flex items-center justify-between w-full border-b py-4 last:border-b-0'>
            <span className='text-lg font-medium text-gray-700'>{label}</span>
            <div className='flex items-center gap-4'>
                <button 
                    onClick={() => setValue(value > 1 ? value - 1 : 1)}
                    className='w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:border-black transition-colors'
                >
                    <FaMinus size={10} />
                </button>
                <span className='text-lg font-semibold w-4 text-center'>{value}</span>
                <button 
                    onClick={() => setValue(value + 1)}
                    className='w-8 h-8 rounded-full border border-gray-300 flex items-center justify-center hover:border-black transition-colors'
                >
                    <FaPlus size={10} />
                </button>
            </div>
        </div>
    );

    return (
        <div className='w-full min-h-screen bg-white flex flex-col items-center py-10 px-4 relative pb-28'>
            
            {/* Header Section */}
            <div className="w-full max-w-[900px] flex items-center justify-between mb-8">
                <div 
                    className='w-12 h-12 bg-red-600 cursor-pointer rounded-full flex items-center justify-center hover:bg-red-700 transition-all shadow-md' 
                    onClick={() => navigate("/listingpage1")}
                >
                    <FaLongArrowAltLeft className='w-6 h-6 text-white' />
                </div>
                <div className='bg-black text-white px-6 py-2 rounded-full text-sm font-semibold shadow-sm'>
                    Step 2 of 2: Details
                </div>
            </div>

            <div className='max-w-[800px] w-full flex flex-col items-center md:items-start'>
                
                {/* 1. Category Section */}
                <h1 className='text-2xl md:text-3xl font-bold text-gray-800 mb-2'>Which best describes your place?</h1>
                <p className='text-gray-500 mb-6'>Pick a category so guests know what to expect.</p>

                <div className='grid grid-cols-2 md:grid-cols-3 gap-4 w-full mb-12'>
                    {categories.map((item) => (
                        <div 
                            key={item.id}
                            onClick={() => setCategory(item.id)}
                            className={`flex flex-col items-center justify-center p-6 border-2 rounded-2xl cursor-pointer transition-all hover:border-black active:scale-95 ${
                                category === item.id 
                                ? 'border-black bg-gray-50 shadow-inner' 
                                : 'border-gray-100'
                            }`}
                        >
                            <div className={`mb-2 ${category === item.id ? 'text-red-600' : 'text-gray-700'}`}>
                                {item.icon}
                            </div>
                            <span className={`font-semibold text-sm ${category === item.id ? 'text-black' : 'text-gray-600'}`}>
                                {item.label}
                            </span>
                        </div>
                    ))}
                </div>

                {/* 2. Basics Section (Guests, Rooms, etc) */}
                <h1 className='text-2xl md:text-3xl font-bold text-gray-800 mb-2'>Share some basics</h1>
                <p className='text-gray-500 mb-6'>You'll add more details later, like bed types.</p>
                
                <div className='w-full max-w-lg mb-12'>
                    <Counter label="Guests" value={guestCount} setValue={setGuestCount} />
                    <Counter label="Bedrooms" value={bedroomCount} setValue={setBedroomCount} />
                    <Counter label="Bathrooms" value={bathroomCount} setValue={setBathroomCount} />
                </div>

                {/* Navigation Button */}
                <div className='fixed bottom-0 left-0 w-full bg-white border-t border-gray-100 p-4 flex justify-center z-50'>
                    <button 
                        className='max-w-[800px] w-full bg-red-600 text-white py-4 rounded-xl text-xl font-bold hover:bg-red-700 transition-all shadow-lg disabled:bg-gray-200 disabled:text-gray-400 disabled:cursor-not-allowed'
                        onClick={() => navigate("/listingpage3")}
                        disabled={!category}
                    >
                        Next
                    </button>
                </div>
            </div>
        </div>
    );
}

export default ListingPage2;
"""
_____________________________________
--- frontend/src/pages/ListingPage3.jsx ---

"""
import React, { useContext } from 'react';
import { FaLongArrowAltLeft, FaCheckCircle } from "react-icons/fa";
import { useNavigate } from 'react-router-dom';
import { listingDataContext } from '../Context/ListingContext';

function ListingPage3() {
    let navigate = useNavigate();
    let {
        title,
        description,
        frontEndImage1,
        frontEndImage2,
        frontEndImage3,
        rent,
        city,
        landmark,
        category,
        handleAddListing,
        adding,
        // New values for review
        guestCount,
        bedroomCount,
        bathroomCount
    } = useContext(listingDataContext);

    return (
        <div className='w-full min-h-screen bg-white flex flex-col items-center py-10 px-4 relative pb-24'>
            
            {/* Header */}
            <div className="w-full max-w-[1000px] flex items-center justify-between mb-8">
                <div 
                    className='w-12 h-12 bg-red-600 cursor-pointer rounded-full flex items-center justify-center hover:bg-red-700 transition-all shadow-md' 
                    onClick={() => navigate("/listingpage2")}
                >
                    <FaLongArrowAltLeft className='w-6 h-6 text-white' />
                </div>
                <div className='bg-black text-white px-6 py-2 rounded-full text-sm font-semibold shadow-sm'>
                    Final Step: Review Your Listing
                </div>
            </div>

            <div className='max-w-[1000px] w-full flex flex-col gap-8'>
                
                {/* 1. Image Gallery Section */}
                <div className='flex flex-col gap-4'>
                    <div className='w-full h-[300px] md:h-[450px] rounded-3xl overflow-hidden shadow-md border-2 border-gray-100'>
                        <img src={frontEndImage1} alt="Main" className='w-full h-full object-cover' />
                    </div>
                    <div className='grid grid-cols-2 gap-4 h-[150px] md:h-[250px]'>
                        <div className='rounded-3xl overflow-hidden shadow-sm border-2 border-gray-100'>
                            <img src={frontEndImage2} alt="Detail 1" className='w-full h-full object-cover' />
                        </div>
                        <div className='rounded-3xl overflow-hidden shadow-sm border-2 border-gray-100'>
                            <img src={frontEndImage3} alt="Detail 2" className='w-full h-full object-cover' />
                        </div>
                    </div>
                </div>

                {/* 2. Review Details Section */}
                <div className='grid grid-cols-1 md:grid-cols-3 gap-10 mt-4'>
                    <div className='md:col-span-2 flex flex-col gap-6'>
                        <div>
                            <h1 className='text-4xl font-extrabold text-gray-900 capitalize'>{title}</h1>
                            {/* UPDATED SUBTITLE */}
                            <p className='text-xl text-gray-500 font-medium mt-1'>
                                {landmark}, {city} 
                            </p>
                            <p className='text-gray-600 mt-2 flex items-center gap-2'>
                                <span className='font-bold text-black'>{category}</span> • 
                                {guestCount} guests • {bedroomCount} bedrooms • {bathroomCount} bathrooms
                            </p>
                        </div>

                        <div className='p-6 bg-gray-50 rounded-3xl border border-gray-100'>
                            <h3 className='text-xl font-bold text-gray-800 mb-3'>Description</h3>
                            <p className='text-gray-600 leading-relaxed whitespace-pre-line'>
                                {description}
                            </p>
                        </div>

                        {/* Submission Summary List */}
                        <div className='flex flex-col gap-3'>
                            <h3 className='text-lg font-bold text-gray-800'>Listing Summary</h3>
                            <div className='grid grid-cols-2 gap-4'>
                                <div className='flex items-center gap-2 text-gray-600'><FaCheckCircle className='text-green-500'/> Location Verified</div>
                                <div className='flex items-center gap-2 text-gray-600'><FaCheckCircle className='text-green-500'/> {category} Category</div>
                                <div className='flex items-center gap-2 text-gray-600'><FaCheckCircle className='text-green-500'/> 3 Images Uploaded</div>
                                <div className='flex items-center gap-2 text-gray-600'><FaCheckCircle className='text-green-500'/> Price Set</div>
                            </div>
                        </div>
                    </div>

                    {/* 3. Action Card */}
                    <div className='md:col-span-1'>
                        <div className='border rounded-[2rem] p-8 shadow-2xl sticky top-24 bg-white'>
                            <div className='flex flex-col gap-1 mb-6'>
                                <span className='text-gray-500 text-sm font-bold uppercase tracking-wider'>Total Rent</span>
                                <div className='flex items-baseline gap-1'>
                                    <span className='text-4xl font-black text-gray-900'>₹{rent}</span>
                                    <span className='text-gray-500 font-medium'>/ night</span>
                                </div>
                            </div>
                            
                            <div className='w-full h-[1px] bg-gray-100 mb-6'></div>
                            
                            <button 
                                className='w-full bg-red-600 text-white py-5 rounded-2xl text-xl font-black hover:bg-red-700 active:scale-95 transition-all shadow-xl shadow-red-100 disabled:bg-gray-300 disabled:shadow-none'
                                onClick={handleAddListing}
                                disabled={adding}
                            >
                                {adding ? "Publishing..." : "Confirm & Publish"}
                            </button>
                            <p className='text-center text-xs text-gray-400 mt-4 px-4'>
                                By publishing, you agree to show this listing to all guests in {city}.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    );
}

export default ListingPage3;
"""
_____________________________________
--- frontend/src/pages/LoginPage.jsx ---

"""
import React, { useContext, useState } from 'react';
import { IoEyeSharp } from "react-icons/io5";
import { FaEyeSlash } from "react-icons/fa6";
import { useNavigate } from 'react-router-dom';
import { FaLongArrowAltLeft } from "react-icons/fa";
import { authDataContext } from '../Context/AuthContext';
import { userDataContext } from '../Context/UserContext';
import axios from 'axios';
import { toast } from 'react-toastify';

function Login() {
  const [show, setShow] = useState(false);
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  
  const navigate = useNavigate();

  // Pulling logic from Context
  const { serverUrl, loading, setLoading } = useContext(authDataContext);
  const { setUserData } = useContext(userDataContext);

  const handleLogin = async (e) => {
    e.preventDefault();
    setLoading(true);
    
    try {
      const result = await axios.post(`${serverUrl}/api/auth/login`, {
        email,
        password
      }, { withCredentials: true });
      
      setLoading(false);
      setUserData(result.data);
      toast.success("Login Successfully");
      navigate("/"); // Redirect to Home after login
      console.log("Login Result:", result);
    } catch (error) {
      setLoading(false);
      console.error("Login Error:", error);
      // Use optional chaining to avoid crashing if error.response is undefined
      toast.error(error.response?.data?.message || "Invalid Credentials");
    }
  };

  return (
    <div className='w-screen h-screen flex items-center justify-center bg-white relative'>
      {/* Back Button to Home */}
      <div 
        className='w-[50px] h-[50px] bg-red-600 cursor-pointer absolute top-[10%] left-[20px] rounded-full flex items-center justify-center hover:bg-red-700 transition-all shadow-md' 
        onClick={() => navigate("/")}
      >
        <FaLongArrowAltLeft className='w-[25px] h-[25px] text-white' />
      </div>

      <form 
        className='max-w-[900px] w-[90%] flex items-center justify-center flex-col md:items-start gap-[15px]'
        onSubmit={handleLogin}
      >
        <h1 className='text-[35px] font-bold text-black mb-4'>Welcome to Airbnb</h1>
        
        {/* Email Input */}
        <div className='w-full flex flex-col gap-2'>
          <label htmlFor="email" className='text-lg font-medium'>Email</label>
          <input 
            type="email" 
            id='email' 
            required
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            placeholder="Enter your email"
            className='w-full h-[45px] border-2 border-gray-400 rounded-lg px-3 focus:border-red-500 outline-none transition-colors'
          />
        </div>

        {/* Password Input */}
        <div className='w-full flex flex-col gap-2 relative'>
          <label htmlFor="password" className='text-lg font-medium'>Password</label>
          <input 
            type={show ? "text" : "password"} 
            id='password' 
            required
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            placeholder="Enter your password"
            className='w-full h-[45px] border-2 border-gray-400 rounded-lg px-3 focus:border-red-500 outline-none transition-colors'
          />
          {/* Eye Toggler */}
          <div 
            className='absolute right-4 bottom-3 cursor-pointer text-gray-600 hover:text-black transition-colors' 
            onClick={() => setShow(!show)}
          >
            {show ? <FaEyeSlash size={22} /> : <IoEyeSharp size={22} />}
          </div>
        </div>

        <button 
          type="submit"
          disabled={loading}
          className='w-full md:w-auto px-12 py-3 bg-red-600 text-white text-lg font-semibold rounded-lg mt-4 hover:bg-red-700 transition-colors shadow-sm disabled:bg-gray-400'
        >
          {loading ? "Logging in..." : "Login"}
        </button>

        <p className='text-gray-600 mt-2 cursor-pointer' onClick={() => navigate("/signup")}>
          New to Airbnb? <span className='text-red-600 font-bold hover:underline'>Create an account</span>
        </p>
      </form>
    </div>
  );
}

export default Login;
"""
_____________________________________
--- frontend/src/pages/MyBooking.jsx ---

"""
import React, { useContext } from 'react'

import { useNavigate } from 'react-router-dom'
import { FaArrowLeftLong } from "react-icons/fa6";
import { userDataContext } from '../Context/UserContext';
import Card from '../Component/Card';


function MyBooking() {
    let navigate = useNavigate()
 
    let {userData}= useContext(userDataContext)
    
    
  return (
    <div className='w-[100vw] min-h-[100vh] flex items-center justify-start flex-col gap-[50px] relative  px-[20px]'>
        <div className='w-[50px] h-[50px] bg-[red] cursor-pointer absolute top-[10%] left-[20px] rounded-[50%] flex items-center justify-center ' onClick={()=>navigate("/")}><FaArrowLeftLong className='w-[25px] h-[25px] text-[white]' /></div>
        <div className='w-[60%] h-[10%] border-[2px] border-[#908c8c] p-[15px] flex items-center justify-center text-[30px] rounded-md text-[#613b3b] font-semibold  mt-[50px] md:w-[600px] text-nowrap'>MY BOOKING</div>
        <div className='w-[100%] h-[90%] flex items-center justify-center gap-[25px] flex-wrap mt-[30px] '>
        {userData.booking?.map((list)=>(
              <Card title={list.title} landMark={list.landMark} city={list.city} image1={list.image1} image2={list.image2} image3={list.image3} rent={list.rent} id={list._id} isBooked={list.isBooked} ratings={list.ratings} host={list.host} />
             ))}    
        

        </div>

      
    </div>
  )
}

export default MyBooking

"""
_____________________________________
--- frontend/src/pages/MyListing.jsx ---

"""
import React, { useContext } from 'react'
import { useNavigate } from 'react-router-dom'
import { FaTrash } from "react-icons/fa"; // Install: npm install react-icons
import { userDataContext } from '../Context/UserContext';
import { listingDataContext } from '../Context/ListingContext';
import Card from '../Component/Card';
import Nav from '../Component/Nav';

function MyListing() {
    let navigate = useNavigate();
    // We need userData to know WHO we are
    let { userData } = useContext(userDataContext);
    // We need listing data and the delete function from Context
    let { listingData = [], handleDeleteListing } = useContext(listingDataContext);

    // Filter: Show only listings where the 'host' matches the logged-in user's ID
    const myListings = listingData.filter((list) => {
        // Handle cases where host is populated (object) or just an ID (string)
        const hostId = list.host?._id || list.host;
        return hostId === userData?._id;
    });

    return (
        <div className='w-full min-h-screen bg-gray-50'>
            {/* 1. Reuse your Navbar for consistency */}
            <Nav />

            <div className='w-full max-w-[1400px] mx-auto pt-[200px] px-6 pb-20'>
                
                {/* 2. Header Section */}
                <div className='flex items-center justify-between mb-8'>
                    <h1 className='text-3xl font-bold text-gray-800'>My Hosted Listings</h1>
                    <button 
                        onClick={() => navigate("/listingpage1")}
                        className='bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-semibold transition-all'
                    >
                        + Add New
                    </button>
                </div>

                {/* 3. Listings Grid */}
                <div className='flex items-start justify-center gap-6 flex-wrap'>
                    {myListings.length > 0 ? (
                        myListings.map((list) => (
                            <div key={list._id} className='relative group'>
                                {/* The Card Component */}
                                <Card 
                                    title={list.title} 
                                    landMark={list.landmark} // Note: check if your DB uses 'landmark' or 'landMark'
                                    city={list.city} 
                                    image1={list.image1} 
                                    rent={list.rent} 
                                    id={list._id} 
                                    ratings={list.averageRating || 0}
                                />

                                {/* DELETE BUTTON (Overlay) */}
                                <button 
                                    onClick={(e) => {
                                        e.stopPropagation(); // Stop click from opening the card details
                                        if(window.confirm("Delete this listing permanently?")) {
                                            handleDeleteListing(list._id);
                                        }
                                    }}
                                    className='absolute top-3 right-3 bg-white text-red-500 p-2 rounded-full shadow-md hover:bg-red-500 hover:text-white transition-all opacity-0 group-hover:opacity-100 z-10'
                                    title="Delete Listing"
                                >
                                    <FaTrash size={14} />
                                </button>
                            </div>
                        ))
                    ) : (
                        // Empty State
                        <div className="flex flex-col items-center justify-center mt-20 text-center space-y-4 opacity-60">
                            <div className="w-20 h-20 bg-gray-200 rounded-full flex items-center justify-center text-3xl">📂</div>
                            <h2 className="text-xl font-bold text-gray-700">No Listings Yet</h2>
                            <p className="text-gray-500">You haven't posted any flats yet.</p>
                        </div>
                    )}
                </div>
            </div>
        </div>
    )
}

export default MyListing;
"""
_____________________________________
--- frontend/src/pages/SignUpPage.jsx ---

"""
import React, { useState, useContext } from 'react'; // <--- FIXED: Added useContext
import { IoMdEye, IoMdEyeOff } from "react-icons/io";
import { useNavigate } from 'react-router-dom';
import { FaLongArrowAltLeft } from "react-icons/fa";
import axios from 'axios';
import { authDataContext } from '../Context/AuthContext';
import { userDataContext } from '../Context/UserContext';
import { toast } from 'react-toastify';
import { FaHatWizard } from 'react-icons/fa6';

function SignUp() {
    const [show, setShow] = useState(false);
    const [name, setName] = useState("");
    const [email, setEmail] = useState("");
    const [password, setPassword] = useState("");
    
    const navigate = useNavigate();
    
    // Using the context that was causing the crash
    const { serverUrl, loading, setLoading } = useContext(authDataContext);
    const { setUserData } = useContext(userDataContext);

    const handleSignUP = async (e) => {
        e.preventDefault();
        setLoading(true);
        
        try {
            const result = await axios.post(`${serverUrl}/api/auth/signup`, {
                name,
                email,
                password
            }, { withCredentials: true });
            
            setLoading(false);
            setUserData(result.data);
            toast.success("Signup Successfully");
            navigate("/");
        } catch (error) {
            setLoading(false);
            console.error(error);
            toast.error(error.response?.data?.message || "Something went wrong");
        }
    };

    return (
        <div className='w-screen h-screen flex items-center justify-center bg-white relative'>
            <div 
                className='w-[50px] h-[50px] bg-red-600 cursor-pointer absolute top-[10%] left-[20px] rounded-full flex items-center justify-center hover:bg-red-700 transition-all shadow-md' 
                onClick={() => navigate("/")}
            >
                <FaLongArrowAltLeft className='w-[25px] h-[25px] text-white' />
            </div>

            <form className='max-w-[900px] w-[90%] flex flex-col items-center md:items-start gap-4' onSubmit={handleSignUP}>
                <h1 className='text-[35px] font-bold text-black'>Welcome to Airbnb</h1>
                
                <div className='w-full flex flex-col gap-1 mt-4'>
                    <label className='text-lg font-medium'>UserName</label>
                    <input 
                        type="text" 
                        className='w-full h-[45px] border-2 border-gray-400 rounded-lg px-4 focus:border-red-500 outline-none' 
                        required 
                        onChange={(e) => setName(e.target.value)} 
                        value={name}
                    />
                </div> 

                <div className='w-full flex flex-col gap-1'>
                    <label className='text-lg font-medium'>Email</label>
                    <input 
                        type="email" 
                        className='w-full h-[45px] border-2 border-gray-400 rounded-lg px-4 focus:border-red-500 outline-none' 
                        required 
                        onChange={(e) => setEmail(e.target.value)} 
                        value={email}
                    />
                </div> 

                <div className='w-full flex flex-col gap-1 relative'>
                    <label className='text-lg font-medium'>Password</label>
                    <input 
                        type={show ? "text" : "password"} 
                        className='w-full h-[45px] border-2 border-gray-400 rounded-lg px-4 focus:border-red-500 outline-none' 
                        required 
                        onChange={(e) => setPassword(e.target.value)} 
                        value={password} 
                    />
                    <div className='absolute right-4 bottom-3 cursor-pointer text-gray-600' onClick={() => setShow(!show)}>
                        {show ? <IoMdEyeOff size={22} /> : <IoMdEye size={22} />}
                    </div>
                </div>

                <button 
                    className='w-full md:w-auto px-12 py-3 bg-red-600 text-white text-lg font-semibold rounded-lg mt-4 disabled:bg-gray-400 shadow-sm' 
                    disabled={loading}
                >
                    {loading ? "Creating Account..." : "Sign Up"}
                </button>

                <p className='text-gray-600 mt-2'>
                    Already have an account? <span className='text-red-600 font-bold cursor-pointer hover:underline' onClick={() => navigate("/login")}>Login</span>
                </p>
            </form>
        </div>
    );
}

export default SignUp;
"""
_____________________________________
--- frontend/src/pages/ViewCard.jsx ---

"""
import React, { useContext, useEffect, useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { FaArrowLeftLong } from "react-icons/fa6";
import { RxCross2 } from "react-icons/rx";
import { FaStar, FaMapMarkerAlt, FaRegHeart, FaShare } from "react-icons/fa";
import { toast } from 'react-toastify';
import axios from 'axios';

import { listingDataContext } from '../Context/ListingContext';
import { userDataContext } from '../Context/UserContext';
import { authDataContext } from '../Context/AuthContext';
import { bookingDataContext } from '../Context/BookingContext';
import Nav from '../Component/Nav'; 

function ViewCard() {
    const navigate = useNavigate();
    const { cardDetails, setUpdating, updating, setDeleting, deleting } = useContext(listingDataContext);
    const { userData } = useContext(userDataContext);
    const { serverUrl } = useContext(authDataContext);
    
    // Booking Context
    const { 
        checkIn, setCheckIn, 
        checkOut, setCheckOut, 
        total, setTotal, 
        night, setNight, 
        handleBooking, booking 
    } = useContext(bookingDataContext);

    // Local State
    const [updatePopUp, setUpdatePopUp] = useState(false);
    const [bookingPopUp, setBookingPopUp] = useState(false);
    const [minDate, setMinDate] = useState("");
    
    // Form States 
    const [title, setTitle] = useState(cardDetails?.title || "");
    const [description, setDescription] = useState(cardDetails?.description || "");
    const [rent, setRent] = useState(cardDetails?.rent || "");
    const [city, setCity] = useState(cardDetails?.city || "");
    const [landmark, setLandmark] = useState(cardDetails?.landMark || ""); 
    const [backEndImage1, setBackEndImage1] = useState(null);
    const [backEndImage2, setBackEndImage2] = useState(null);
    const [backEndImage3, setBackEndImage3] = useState(null);

    // CRITICAL: Prevent crash if page is refreshed
    useEffect(() => {
        if (!cardDetails) {
            navigate("/"); 
        }
        const today = new Date().toISOString().split('T')[0];
        setMinDate(today);
    }, [cardDetails, navigate]);

    // Booking Calculation Logic
    useEffect(() => {
        if (checkIn && checkOut && cardDetails) {
            const inDate = new Date(checkIn);
            const outDate = new Date(checkOut);
            const timeDiff = outDate - inDate;
            const days = timeDiff / (1000 * 3600 * 24);

            setNight(days);

            if (days > 0) {
                const basePrice = cardDetails.rent * days;
                const taxes = basePrice * 0.14; 
                setTotal(Math.round(basePrice + taxes));
            } else {
                setTotal(0);
            }
        }
    }, [checkIn, checkOut, cardDetails, setNight, setTotal]);

 

    // Update Handler
    const handleUpdateListing = async () => {
        setUpdating(true);
        try {
            const formData = new FormData();
            formData.append("title", title);
            formData.append("description", description);
            formData.append("rent", rent);
            formData.append("city", city);
            formData.append("landmark", landmark); 
            if (backEndImage1) formData.append("image1", backEndImage1);
            if (backEndImage2) formData.append("image2", backEndImage2);
            if (backEndImage3) formData.append("image3", backEndImage3);

            await axios.post(`${serverUrl}/api/listing/update/${cardDetails._id}`, formData, { withCredentials: true });
            
            toast.success("Listing Updated Successfully");
            setUpdatePopUp(false);
            navigate("/"); 
        } catch (error) {
            console.error(error);
            toast.error(error.response?.data?.message || "Update Failed");
        } finally {
            setUpdating(false);
        }
    };

    // Delete Handler
    const handleDeleteListing = async () => {
        if(!window.confirm("Are you sure you want to delete this listing?")) return;
        
        setDeleting(true);
        try {
            await axios.delete(`${serverUrl}/api/listing/delete/${cardDetails._id}`, { withCredentials: true });
            toast.success("Listing Deleted");
            navigate("/");
        } catch (error) {
            console.error(error);
            toast.error("Delete Failed");
        } finally {
            setDeleting(false);
        }
    };

    if (!cardDetails) return null; 

    const isHost = cardDetails.host === userData?._id || cardDetails.host?._id === userData?._id;

    return (
        <div className='w-full min-h-screen bg-white'>
            <Nav />
            
            <div className='max-w-[1200px] mx-auto px-4 pt-[170px] pb-20'>
                
                {/* 0. NEW: Back Button Section */}
                <div className='mb-4'>
                    <button 
                        onClick={() => navigate(-1)} 
                        className='flex items-center gap-2 text-gray-600 hover:text-black hover:bg-gray-100 px-3 py-2 rounded-lg transition-all'
                    >
                        <FaArrowLeftLong size={20} />
                        <span className='font-medium'>Back</span>
                    </button>
                </div>

                {/* 1. Header Section */}
                <div className='mb-6'>
                    <h1 className='text-2xl md:text-3xl font-bold text-gray-900 mb-2 capitalize'>{cardDetails.title}</h1>
                    <div className='flex items-center justify-between text-sm text-gray-600 underline'>
                        <div className='flex items-center gap-2'>
                            <FaStar className='text-rose-500' />
                            <span className='font-semibold'>4.8</span>
                            <span>•</span>
                            <span className='font-semibold capitalize'>{cardDetails.city}, {cardDetails.landMark}</span>
                        </div>
                        <div className='flex gap-4'>
                            <button className='flex items-center gap-1 hover:bg-gray-100 px-2 py-1 rounded'><FaShare /> Share</button>
                            <button className='flex items-center gap-1 hover:bg-gray-100 px-2 py-1 rounded'><FaRegHeart /> Save</button>
                        </div>
                    </div>
                </div>

                {/* 2. Image Grid (The Airbnb Look) */}
                <div className='grid grid-cols-1 md:grid-cols-4 grid-rows-2 gap-2 h-[400px] rounded-2xl overflow-hidden mb-8'>
                    {/* Main Image (Left Half) */}
                    <div className='md:col-span-2 md:row-span-2 relative group cursor-pointer'>
                        <img src={cardDetails.image1} alt="Main" className='w-full h-full object-cover hover:opacity-95 transition' />
                    </div>
                    {/* Top Right */}
                    <div className='hidden md:block md:col-span-2 md:row-span-1 relative group cursor-pointer'>
                        <img src={cardDetails.image2} alt="Second" className='w-full h-full object-cover hover:opacity-95 transition' />
                    </div>
                    {/* Bottom Right */}
                    <div className='hidden md:block md:col-span-2 md:row-span-1 relative group cursor-pointer'>
                        <img src={cardDetails.image3} alt="Third" className='w-full h-full object-cover hover:opacity-95 transition' />
                    </div>
                </div>

                {/* 3. Main Content Split */}
                <div className='flex flex-col md:flex-row gap-12'>
                    
                    {/* LEFT COLUMN: Details */}
                    <div className='w-full md:w-[65%]'>
                        <div className='border-b pb-6 mb-6'>
                            <h2 className='text-xl font-semibold mb-1'>Entire home hosted by {cardDetails.host?.username || "Host"}</h2>
                            <p className='text-gray-500'>6 guests • 3 bedrooms • 2 bathrooms</p>
                        </div>
                        <div className='mb-6'>
                            <h3 className='text-xl font-semibold mb-4'>About this place</h3>
                            <p className='text-gray-700 leading-relaxed whitespace-pre-wrap'>{cardDetails.description}</p>
                        </div>
                        
                        {/* Host Controls (If Owner) */}
                        {isHost && (
                            <div className='p-4 bg-gray-50 rounded-xl border border-gray-200 mt-8'>
                                <h3 className='font-bold mb-3'>Host Controls</h3>
                                <div className='flex gap-4'>
                                    <button onClick={() => setUpdatePopUp(true)} className='bg-black text-white px-4 py-2 rounded-lg text-sm font-semibold hover:opacity-80'>
                                        Edit Listing
                                    </button>
                                    <button onClick={handleDeleteListing} disabled={deleting} className='text-red-600 underline text-sm font-semibold'>
                                        {deleting ? "Deleting..." : "Delete Listing"}
                                    </button>
                                </div>
                            </div>
                        )}
                    </div>

                    {/* RIGHT COLUMN: Sticky Booking Card */}
                    <div className='w-full md:w-[35%]'>
                        <div className='sticky top-28 border border-gray-200 shadow-xl rounded-2xl p-6'>
                            <div className='flex justify-between items-baseline mb-6'>
                                <div className='flex items-baseline gap-1'>
                                    <span className='text-2xl font-bold'>₹{cardDetails.rent.toLocaleString()}</span>
                                    <span className='text-gray-500'>/ night</span>
                                </div>
                                <div className='flex items-center gap-1 text-sm'>
                                    <FaStar className='text-rose-500' /> 4.8
                                </div>
                            </div>

                            {!isHost ? (
                                <button 
                                    onClick={() => setBookingPopUp(true)}
                                    className='w-full bg-rose-600 text-white py-3 rounded-lg font-bold text-lg hover:bg-rose-700 transition active:scale-95'
                                >
                                    Reserve
                                </button>
                            ) : (
                                <div className='text-center p-4 bg-green-50 text-green-700 rounded-lg font-medium border border-green-200'>
                                    You are the host of this property
                                </div>
                            )}

                            <div className='mt-4 text-center text-gray-400 text-sm'>
                                You won't be charged yet
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            {/* --- MODALS --- */}

            {/* UPDATE POPUP */}
            {updatePopUp && (
                <div className='fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm'>
                    <div className='bg-white w-full max-w-lg rounded-2xl p-6 relative max-h-[90vh] overflow-y-auto shadow-2xl'>
                        <button onClick={() => setUpdatePopUp(false)} className='absolute top-4 right-4 p-2 hover:bg-gray-100 rounded-full'><RxCross2 size={20}/></button>
                        <h2 className='text-2xl font-bold mb-6'>Edit Listing</h2>
                        
                        <div className='space-y-4'>
                            <div>
                                <label className='block text-sm font-medium text-gray-700 mb-1'>Title</label>
                                <input value={title} onChange={e => setTitle(e.target.value)} className='w-full p-3 border rounded-lg' />
                            </div>
                            <div className='grid grid-cols-2 gap-4'>
                                <div>
                                    <label className='block text-sm font-medium text-gray-700 mb-1'>Price</label>
                                    <input type="number" value={rent} onChange={e => setRent(e.target.value)} className='w-full p-3 border rounded-lg' />
                                </div>
                                <div>
                                    <label className='block text-sm font-medium text-gray-700 mb-1'>City</label>
                                    <input value={city} onChange={e => setCity(e.target.value)} className='w-full p-3 border rounded-lg' />
                                </div>
                            </div>
                            <div>
                                <label className='block text-sm font-medium text-gray-700 mb-1'>Description</label>
                                <textarea value={description} onChange={e => setDescription(e.target.value)} rows={4} className='w-full p-3 border rounded-lg' />
                            </div>
                            <button onClick={handleUpdateListing} disabled={updating} className='w-full bg-black text-white py-3 rounded-lg font-bold mt-4'>
                                {updating ? "Saving..." : "Save Changes"}
                            </button>
                        </div>
                    </div>
                </div>
            )}

            {/* BOOKING POPUP */}
            {bookingPopUp && (
                <div className='fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm'>
                    <div className='bg-white w-full max-w-md rounded-2xl p-6 relative shadow-2xl'>
                        <button onClick={() => setBookingPopUp(false)} className='absolute top-4 right-4 p-2 hover:bg-gray-100 rounded-full'><RxCross2 size={20}/></button>
                        <h2 className='text-2xl font-bold mb-6 border-b pb-4'>{booking ? "Booking..." : "Confirm Booking" }</h2>
                        {/* for gemini
                        this was youtuber's code>> <div className='w-[100%] flex items-center justify-center'><button className='px-[80px] py-[10px] bg-[red] text-[white] text-[18px] md:px-[100px] rounded-lg text-nowrap mt-[30px]' onClick={() => {handleBooking(cardDetails._id)}} disabled={booking}>{booking ? "Booking..." : "Book Now"}</button></div>
 */}
                        
                        <div className='space-y-4 mb-6'>
                            <div className='grid grid-cols-2 gap-2'>
                                <div className='border rounded-lg p-3'>
                                    <div className='text-xs font-bold uppercase text-gray-500'>Check-In</div>
                                    <input type="date" min={minDate} value={checkIn} onChange={e => setCheckIn(e.target.value)} className='w-full outline-none text-sm' />
                                </div>
                                <div className='border rounded-lg p-3'>
                                    <div className='text-xs font-bold uppercase text-gray-500'>Check-Out</div>
                                    <input type="date" min={checkIn || minDate} value={checkOut} onChange={e => setCheckOut(e.target.value)} className='w-full outline-none text-sm' />
                                </div>
                            </div>
                        </div>

                        {night > 0 && (
                            <div className='bg-gray-50 p-4 rounded-lg space-y-2 mb-6'>
                                <div className='flex justify-between'>
                                    <span className='underline'>₹{cardDetails.rent} x {night} nights</span>
                                    <span>₹{cardDetails.rent * night}</span>
                                </div>
                                <div className='flex justify-between'>
                                    <span className='underline'>Service Fee (14%)</span>
                                    <span>₹{Math.round((cardDetails.rent * night) * 0.14)}</span>
                                </div>
                                <div className='flex justify-between font-bold pt-2 border-t mt-2'>
                                    <span>Total</span>
                                    <span>₹{total.toLocaleString()}</span>
                                </div>
                            </div>
                        )}

                        <button 
                            onClick={() => handleBooking(cardDetails._id)} 
                            disabled={booking || night <= 0}
                            className={`w-full py-3 rounded-lg font-bold text-white ${booking || night <= 0 ? 'bg-gray-400 cursor-not-allowed' : 'bg-rose-600 hover:bg-rose-700'}`}
                        >
                            {booking ? "Processing..." : "Confirm & Pay"}
                        </button>
                    </div>
                </div>
            )}

        </div>
    );
}

export default ViewCard;
"""
_____________________________________
--- frontend/src/App.jsx ---

"""
// import React, { useContext } from 'react'
// import { Routes, Route, Navigate } from 'react-router-dom'
// import HomePage from './pages/HomePage'
// import LoginPage from './pages/LoginPage'
// import SignUpPage from './pages/SignUpPage'
// import ListingPage1 from './pages/ListingPage1'
// import ListingPage2 from './pages/ListingPage2'
// import ListingPage3 from './pages/ListingPage3'
// import MyListing from './pages/MyListing' 
// import ViewCard from './pages/ViewCard' // <--- 1. ADD THIS IMPORT
// import { userDataContext } from './Context/UserContext'
// import MyBooking from './pages/MyBooking'

// // The "Security Guard" component
// const ProtectedRoute = ({ children }) => {
//   const { userData } = useContext(userDataContext);
  
//   if (!userData) {
//     // If not logged in, send them to login
//     return <Navigate to="/login" replace />;
//   }
//   return children;
// };

// function App() {
//   return (
//     <Routes>
//       <Route path="/" element={<HomePage />} />
//       <Route path="/login" element={<LoginPage />} />
//       <Route path="/signup" element={<SignUpPage />} />

//       {/* Locked Routes - Wrap them in ProtectedRoute */}
//       <Route path="/listingpage1" element={
//         <ProtectedRoute>
//           <ListingPage1 />
//         </ProtectedRoute>
//       } />
      
//       <Route path="/listingpage2" element={
//         <ProtectedRoute>
//           <ListingPage2 />
//         </ProtectedRoute>
//       } />

//       <Route path="/listingpage3" element={
//         <ProtectedRoute>
//           <ListingPage3 />
//         </ProtectedRoute>
//       } />

//       {/* New: path="/mylisting" */}
//       <Route path="/mylisting" element={
//         <ProtectedRoute>
//           <MyListing />
//         </ProtectedRoute>
//       } />

//       {/* 2. ADD THIS ROUTE HERE */}
//       {/* I put it inside ProtectedRoute so only logged-in users can view details. 
//           Move it outside if you want it public. */}
//       <Route path="/viewcard" element={
//         <ProtectedRoute>
//            <ViewCard />
//         </ProtectedRoute>
//       } />
//       <Route path="/mybooking" element={
//         <ProtectedRoute>
//            <MyBooking />
//         </ProtectedRoute>
//       } />

//     </Routes>
//   )
// }

// export default App

import React, { useContext } from 'react'
import { Routes, Route, Navigate } from 'react-router-dom'
import HomePage from './pages/HomePage'
import LoginPage from './pages/LoginPage'
import SignUpPage from './pages/SignUpPage'
import ListingPage1 from './pages/ListingPage1'
import ListingPage2 from './pages/ListingPage2'
import ListingPage3 from './pages/ListingPage3'
import MyListing from './pages/MyListing'
import ViewCard from './pages/ViewCard'
import MyBooking from './pages/MyBooking'
import { userDataContext } from './Context/UserContext'
import { ToastContainer } from 'react-toastify'

function App() {
  const { userData } = useContext(userDataContext)

  return (
    <>
    <ToastContainer />
    <Routes>
      <Route path="/" element={<HomePage />} />
      <Route path="/login" element={<LoginPage />} />
      <Route path="/signup" element={<SignUpPage />} />

      <Route
        path="/listingpage1"
        element={userData != null ? <ListingPage1 /> : <Navigate to="/" />}
        />

      <Route
        path="/listingpage2"
        element={userData != null ? <ListingPage2 /> : <Navigate to="/" />}
        />

      <Route
        path="/listingpage3"
        element={userData != null ? <ListingPage3 /> : <Navigate to="/" />}
        />

      <Route
        path="/mylisting"
        element={userData != null ? <MyListing /> : <Navigate to="/" />}
        />

      <Route
        path="/viewcard"
        element={userData != null ? <ViewCard /> : <Navigate to="/" />}
      />

      <Route
        path="/mybooking"
        element={userData != null ? <MyBooking /> : <Navigate to="/" />}
        />
    </Routes>
        </>
  )
}

export default App

"""
_____________________________________
--- frontend/src/App.css ---

"""
<<< EMPTY >>>
"""
_____________________________________
--- frontend/src/index.css ---

"""
@tailwind base;
@tailwind components;
@tailwind utilities;
"""
_____________________________________
--- frontend/src/main.jsx ---

"""
import { StrictMode } from 'react'
import { createRoot } from 'react-dom/client'
import './index.css'
import App from './App'
import { BrowserRouter } from 'react-router-dom'
import AuthContext from './Context/AuthContext' 
import UserContext from './Context/UserContext'
import ListingContext from './Context/ListingContext'
import BookingContext from './Context/BookingContext' // <--- 1. Import it here
import { ToastContainer } from 'react-toastify';
import 'react-toastify/dist/ReactToastify.css';

createRoot(document.getElementById('root')).render(
  <BrowserRouter> 
    <AuthContext>
      <UserContext>
        <ListingContext> 
          {/* 2. Wrap App inside BookingContext */}
          {/* BookingContext needs Listing, User, and Auth to exist first! */}
          <BookingContext>
             <App />
             <ToastContainer position="top-center" autoClose={3000} />
          </BookingContext>
        </ListingContext>
      </UserContext>
    </AuthContext>
  </BrowserRouter>
)
"""
_____________________________________
--- frontend/index.html ---

"""
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="airbnb_logo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AirBnb</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
`
"""
_____________________________________
--- frontend/package.json ---

"""
{
  "name": "frontend",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "@tailwindcss/vite": "^4.1.18",
    "axios": "^1.13.4",
    "react": "^19.2.0",
    "react-dom": "^19.2.0",
    "react-hot-toast": "^2.6.0",
    "react-icons": "^5.5.0",
    "react-router-dom": "^7.13.0",
    "react-toastify": "^11.0.5"
  },
  "devDependencies": {
    "@eslint/js": "^9.39.1",
    "@types/react": "^19.2.5",
    "@types/react-dom": "^19.2.3",
    "@vitejs/plugin-react": "^5.1.1",
    "autoprefixer": "^10.4.24",
    "eslint": "^9.39.1",
    "eslint-plugin-react-hooks": "^7.0.1",
    "eslint-plugin-react-refresh": "^0.4.24",
    "globals": "^16.5.0",
    "postcss": "^8.5.6",
    "tailwindcss": "^3.4.19",
    "vite": "npm:rolldown-vite@7.2.5"
  },
  "overrides": {
    "vite": "npm:rolldown-vite@7.2.5"
  }
}
"""